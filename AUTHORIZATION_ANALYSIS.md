# üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## üìÅ –ò—Å—Å–ª–µ–¥—É–µ–º—ã–µ –ø—Ä–æ–µ–∫—Ç—ã
- `/var/datingapp` - –ø—Ä–æ–µ–∫—Ç —Å –≥–æ—Ç–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `/var/GrantService` - –ø—Ä–æ–µ–∫—Ç, –≤ –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é

## üìã –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

### DatingApp

#### 1. –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- **–ú–µ—Ç–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**: –°—Å—ã–ª–∫–∏ —Å —Ç–æ–∫–µ–Ω–∞–º–∏, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–µ —á–µ—Ä–µ–∑ URL
- **–¢–∏–ø —Ç–æ–∫–µ–Ω–∞**: –°–∞–º–æ–¥–µ–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã, —Ö—Ä–∞–Ω—è—â–∏–µ—Å—è –≤ –ë–î
- **–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è**: 24 —á–∞—Å–∞
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤**: –°–ø–∏—Å–∫–∏ `ALLOWED_USERS` –∏ `ADMIN_USERS` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞
- **–ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä**: Telegram –±–æ—Ç (`/start login` –∏–ª–∏ —á–µ—Ä–µ–∑ –º–µ–Ω—é)
- **–ê–ª–≥–æ—Ä–∏—Ç–º**:
  1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å—Å—ã–ª–∫—É —á–µ—Ä–µ–∑ –±–æ—Ç–∞
 2. –ë–æ—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω —Ñ–æ—Ä–º–∞—Ç–∞ `token_<timestamp>_<random_hex>`
  3. –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–æ–ª–µ `login_token` —Ç–∞–±–ª–∏—Ü—ã `users`
  4. –§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è URL: `https://dating.onff.ru?token=<token>`
  5. –°—Å—ã–ª–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

#### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
- **–ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∏**: –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞ –≤ Streamlit –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- **–ê–ª–≥–æ—Ä–∏—Ç–º**:
  1. –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è —Ç–æ–∫–µ–Ω –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ URL
  2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞ (–Ω–µ —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤)
  3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ –ë–î
  4. –ü–æ–ª—É—á–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ —Ç–æ–∫–µ–Ω—É
  5. –ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
  6. –ü—Ä–∏ —É—Å–ø–µ—Ö–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–µ—Å—Å–∏—è –≤ `st.session_state`

#### 4. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã
- **Telegram –±–æ—Ç** (`telegram_bot/main.py`):
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤ (`get_or_create_login_token`, `refresh_login_token`)
  - –û—Ç–ø—Ä–∞–≤–∫–∞ —Å—Å—ã–ª–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
  - –•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ë–î

- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** (`shared/database.py`):
  - –ü–æ–ª–µ `login_token` –≤ –º–æ–¥–µ–ª–∏ `User`
  - –§—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å —Ç–æ–∫–µ–Ω–∞–º–∏:
    - `get_or_create_login_token` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
    - `validate_login_token` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
    - `refresh_login_token` - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

- **Streamlit –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** (`user_panel/app.py`):
  - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∏–∑ URL
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ `validate_login_token`
  - –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –≤ `st.session_state`
  - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

#### 5. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **–•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤**: –í –ë–î –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ (–º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å)
- **–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è**: 24 —á–∞—Å–∞
- **–ü–µ—Ä–µ–¥–∞—á–∞**: –ß–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã URL (–º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –Ω–∞ —Å–µ—Å—Å–∏–æ–Ω–Ω—ã–µ –∫—É–∫–∏)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤**: –ß–µ—Ä–µ–∑ —Å–ø–∏—Å–∫–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### GrantService

#### 1. –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- **Telegram –±–æ—Ç**: –ï—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `ALLOWED_USERS` –∏ `ADMIN_USERS`
- **Streamlit –∞–¥–º–∏–Ω–∫–∞**: –ù–µ—Ç —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –ï—Å—Ç—å —Å–ø–∏—Å–∫–∏ `ALLOWED_USERS` –∏ `ADMIN_USERS` –≤ `telegram-bot/config/constants.py`

#### 2. –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤**: –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –ë–î –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–æ–∫–µ–Ω–∞–º–∏
- **Telegram –±–æ—Ç**: –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Å—ã–ª–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- **Streamlit –∞–¥–º–∏–Ω–∫–∞**: –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## üõ†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ GrantService

### 1. –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `login_token` –≤ –º–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –µ—Å—Ç—å) –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤.

### 2. –§—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å —Ç–æ–∫–µ–Ω–∞–º–∏
–°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏:
- `generate_login_token` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
- `get_or_create_login_token` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `validate_login_token` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
- `refresh_login_token` - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

### 3. –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è Telegram –±–æ—Ç–∞
–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã:
- `/login` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Å—ã–ª–∫–∏ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –∞–¥–º–∏–Ω–∫—É
- `/admin` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Å—ã–ª–∫–∏ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –∞–¥–º–∏–Ω–∫—É (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)

### 4. –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤—Ö–æ–¥–∞ –≤ Streamlit
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∏–∑ URL
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### 5. –ó–∞—â–∏—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –∞–¥–º–∏–Ω–∫–∏
–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö –∞–¥–º–∏–Ω–∫–∏.

## üìà –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞
1. **–ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ datingapp
2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –¢–æ–∫–µ–Ω—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º —Å—Ä–æ–∫–æ–º –¥–µ–π—Å—Ç–≤–∏—è
3. **–£–¥–æ–±—Å—Ç–≤–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: –ü—Ä–æ—Å—Ç–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Å—Å—ã–ª–∫—É
4. **–ì–∏–±–∫–æ—Å—Ç—å**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (—Ä–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –¥–æ—Å—Ç—É–ø–∞)

## ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è
1. **–ü–µ—Ä–µ—Ö–≤–∞—Ç —Ç–æ–∫–µ–Ω–∞**: 
   - –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS, —É–º–µ–Ω—å—à–∏—Ç—å —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞

2. **–£—Ç–µ—á–∫–∞ —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ –ª–æ–≥–∏/referrer**:
   - –†–µ—à–µ–Ω–∏–µ: –ù–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å meta —Ç–µ–≥–∏ –¥–ª—è –∑–∞–ø—Ä–µ—Ç–∞ referrer

3. **–ü–µ—Ä–µ–±–æ—Ä —Ç–æ–∫–µ–Ω–æ–≤**:
   - –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–µ —Ç–æ–∫–µ–Ω—ã, –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫

## üìÖ –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
1. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `login_token` –≤ –ë–î (–µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ)
2. –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å —Ç–æ–∫–µ–Ω–∞–º–∏
3. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –≤ Telegram –±–æ—Ç
4. –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞ –≤ Streamlit
5. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö –∞–¥–º–∏–Ω–∫–∏
6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## üìö –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã
- `/var/datingapp/telegram_bot/main.py` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤
- `/var/datingapp/shared/database.py` - —Ä–∞–±–æ—Ç–∞ —Å —Ç–æ–∫–µ–Ω–∞–º–∏ –≤ –ë–î
- `/var/datingapp/user_panel/app.py` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤ –≤ Streamlit
- `/var/GrantService/telegram-bot/main.py` - —Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –±–æ—Ç–µ
- `/var/GrantService/telegram-bot/config/constants.py` - —Å–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π