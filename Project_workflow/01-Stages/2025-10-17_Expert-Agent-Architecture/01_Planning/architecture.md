# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Expert Agent –¥–ª—è GrantService

**–î–∞—Ç–∞:** 2025-10-17
**–í–µ—Ä—Å–∏—è:** 0.1 (Planning)
**–ê–≤—Ç–æ—Ä—ã:** User + Claude Code (grant-architect agent)

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ –ú–æ—Ç–∏–≤–∞—Ü–∏—è](#–∫–æ–Ω—Ü–µ–ø—Ü–∏—è-–∏-–º–æ—Ç–∏–≤–∞—Ü–∏—è)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –û–±–∑–æ—Ä](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π-–æ–±–∑–æ—Ä)
3. [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –°–∏—Å—Ç–µ–º—ã](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-—Å–∏—Å—Ç–µ–º—ã)
4. [–ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö](#–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö)
5. [Expert Agent –ö–ª–∞—Å—Å](#expert-agent-–∫–ª–∞—Å—Å)
6. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ê–≥–µ–Ω—Ç–∞–º–∏](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-–∞–≥–µ–Ω—Ç–∞–º–∏)
7. [Workflow –∏ –ü—Ä–æ—Ü–µ—Å—Å—ã](#workflow-–∏-–ø—Ä–æ—Ü–µ—Å—Å—ã)
8. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –°—Ç–µ–∫](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
9. [5-–≠—Ç–∞–ø–Ω—ã–π –ü–ª–∞–Ω –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏](#5-—ç—Ç–∞–ø–Ω—ã–π-–ø–ª–∞–Ω-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)

---

## –ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ –ú–æ—Ç–∏–≤–∞—Ü–∏—è

### –ò—Å—Ö–æ–¥–Ω–∞—è –∏–¥–µ—è (–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è):

> "–ê –µ—Å–ª–∏ –∫ –Ω–∞—à–∏–º –∞–≥–µ–Ω—Ç–∞–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ —Å–µ—Ä–≤–∏—Å–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∞–≥–µ–Ω—Ç–∞ –≠–∫—Å–ø–µ—Ä—Ç–∞, –∏ —á—Ç–æ–±—ã –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –±—ã–ª–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –¥–æ–æ–±—É—á–∞—Ç—å –∏ —Ä–µ–≤—å—é–≤–µ—Ä–∞, –∏ –ø–∏—Å–∞—Ç–µ–ª—è, –∏ —Ä–µ—Å–µ—Ä—á–µ—Ä–∞, –∏ –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä–∞? –ê —Ç–∞–∫–∂–µ –æ–Ω –±—ã –º–æ–≥ –≤—ã–∑—ã–≤–∞—Ç—å —Ä–µ—Å–µ—Ä—á–µ—Ä–∞ –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —Å–≤–æ–µ–π –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π."

### –ü—Ä–æ–±–ª–µ–º—ã —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:

1. **–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –≤ markdown —Ñ–∞–π–ª–∞—Ö:**
   - –°–ª–æ–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
   - –ù–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç–∏
   - –ù–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞
   - –ë–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (329 KB) –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤–µ—Å—å —Å—Ä–∞–∑—É
   - –ù–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ñ–æ–Ω–¥–æ–≤

2. **–ê–≥–µ–Ω—Ç—ã –Ω–µ "–æ–±—É—á–∞—é—Ç—Å—è":**
   - –ü—Ä–æ–º–ø—Ç—ã —Å—Ç–∞—Ç–∏—á–Ω—ã–µ
   - –ù–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è = —Ä—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ markdown
   - –ù–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø—Ä–∞–≤–¥—ã
   - –ö–∞–∂–¥—ã–π –∞–≥–µ–Ω—Ç —á–∏—Ç–∞–µ—Ç —Å–≤–æ—é —á–∞—Å—Ç—å –ë–ó

3. **–ù–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–∞–º–∏:**
   - Researcher —Å–æ–±–∏—Ä–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –Ω–æ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç –ë–ó –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - Writer/Reviewer –Ω–µ –ø–æ–ª—É—á–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
   - –ù–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–∞–º–∏

### –†–µ—à–µ–Ω–∏–µ: Expert Agent –∫–∞–∫ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ö–∞–±

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**

1. **Single Source of Truth:**
   - PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–ª–Ω–æ–π –ë–ó
   - –í–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å –∏ –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ (—Ç–∞–±–ª–∏—Ü—ã + JSONB)

2. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤:**
   - Expert –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –ë–ó
   - –ê–≥–µ–Ω—Ç—ã –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–µ–π —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
   - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–Ω–∞–Ω–∏—è–º–∏

3. **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫:**
   - –í–µ–∫—Ç–æ—Ä–Ω—ã–µ embeddings (pgvector)
   - –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
   - –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–≤–∏—Å–∏–º—ã–µ –æ—Ç–≤–µ—Ç—ã

4. **–î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
   - Expert ‚Üí Researcher: "–û–±–Ω–æ–≤–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö –§–ü–ì 2025"
   - Researcher ‚Üí Expert: "–í–æ—Ç –Ω–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, —Å–æ—Ö—Ä–∞–Ω–∏ –≤ –ë–ó"
   - Expert ‚Üí Writer/Reviewer: "–í–æ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –∑–∞—è–≤–∫–∏"

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –û–±–∑–æ—Ä

### High-Level Architecture

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    GrantService Ecosystem                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Telegram    ‚îÇ         ‚îÇ          n8n Workflow            ‚îÇ
‚îÇ     Bot      ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§        Orchestrator              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                      ‚îÇ
                         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                         ‚îÇ            ‚îÇ            ‚îÇ
                         ‚ñº            ‚ñº            ‚ñº
                  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                  ‚îÇ   Writer   ‚îÇ ‚îÇReviewer‚îÇ ‚îÇInterview.‚îÇ
                  ‚îÇ   Agent    ‚îÇ ‚îÇ Agent  ‚îÇ ‚îÇ  Agent   ‚îÇ
                  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ            ‚îÇ            ‚îÇ
                         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                      ‚îÇ
                         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                         ‚îÇ    EXPERT AGENT         ‚îÇ
                         ‚îÇ  (Knowledge Hub)        ‚îÇ
                         ‚îÇ                         ‚îÇ
                         ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
                         ‚îÇ  ‚îÇ query_knowledge()‚îÇ   ‚îÇ
                         ‚îÇ  ‚îÇ train_agent()    ‚îÇ   ‚îÇ
                         ‚îÇ  ‚îÇ update_knowledge ‚îÇ   ‚îÇ
                         ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
                         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                      ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ                 ‚îÇ                 ‚îÇ
                    ‚ñº                 ‚ñº                 ‚ñº
            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
            ‚îÇ PostgreSQL ‚îÇ  ‚îÇ  Researcher  ‚îÇ  ‚îÇ  GigaChat  ‚îÇ
            ‚îÇ  + pgvector‚îÇ  ‚îÇ    Agent     ‚îÇ  ‚îÇ    API     ‚îÇ
            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
                  ‚îÇ  Knowledge Base Tables:
                  ‚îú‚îÄ knowledge_sources
                  ‚îú‚îÄ knowledge_sections
                  ‚îú‚îÄ successful_examples
                  ‚îú‚îÄ evaluation_criteria
                  ‚îú‚îÄ knowledge_embeddings
                  ‚îî‚îÄ knowledge_updates
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –∏—Ö —Ä–æ–ª–∏:

1. **Expert Agent (NEW):**
   - –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ö–∞–± –∑–Ω–∞–Ω–∏–π
   - –£–ø—Ä–∞–≤–ª—è–µ—Ç –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
   - –û–±—É—á–∞–µ—Ç –¥—Ä—É–≥–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤
   - –ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Researcher

2. **PostgreSQL + pgvector:**
   - –•—Ä–∞–Ω–∏–ª–∏—â–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞–Ω–∏–π
   - –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏–∫–∏
   - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏ –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å

3. **Writer/Reviewer/Interviewer Agents:**
   - –ü–æ–ª—É—á–∞—é—Ç –∑–Ω–∞–Ω–∏—è –æ—Ç Expert
   - –†–∞–±–æ—Ç–∞—é—Ç —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
   - –§–æ–∫—É—Å–∏—Ä—É—é—Ç—Å—è –Ω–∞ —Å–≤–æ–∏—Ö –∑–∞–¥–∞—á–∞—Ö

4. **Researcher Agent:**
   - –°–æ–±–∏—Ä–∞–µ—Ç –Ω–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –∑–∞–ø—Ä–æ—Å—É Expert
   - –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç Expert –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

5. **n8n Workflow:**
   - –û—Ä–∫–µ—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–∞–º–∏
   - –£–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ—Ç–æ–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

---

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –°–∏—Å—Ç–µ–º—ã

### 1. Expert Agent Service

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:**
- Python 3.11+
- FastAPI (REST API)
- asyncpg (PostgreSQL async driver)
- asyncio (async operations)

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**

1. **Knowledge Query Service:**
   ```python
   POST /api/expert/query
   {
       "question": "–ö–∞–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Å–∏–º–≤–æ–ª–∞–º –≤ —Ä–∞–∑–¥–µ–ª–µ '–û –ø—Ä–æ–µ–∫—Ç–µ'?",
       "fund": "fpg",
       "context": "writing_application"
   }

   Response:
   {
       "answer": "–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞: 300 —Å–∏–º–≤–æ–ª–æ–≤, –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: 5000 —Å–∏–º–≤–æ–ª–æ–≤",
       "sources": [42, 84, 91],
       "confidence": 0.92,
       "relevant_sections": [...]
   }
   ```

2. **Agent Training Service:**
   ```python
   POST /api/expert/train
   {
       "agent_name": "writer",
       "fund": "fpg",
       "section": "project_goals"
   }

   Response:
   {
       "status": "success",
       "updated_prompt": "...",
       "knowledge_items": 15,
       "version": "2025-10-17_v1"
   }
   ```

3. **Knowledge Update Service:**
   ```python
   POST /api/expert/update
   {
       "topic": "fpg_requirements_2025",
       "trigger": "manual|scheduled|researcher"
   }

   Response:
   {
       "status": "updating",
       "researcher_task_id": "task_12345",
       "estimated_time": "5m"
   }
   ```

### 2. Database Service (PostgreSQL + pgvector)

**–í–µ—Ä—Å–∏—è:** PostgreSQL 14+
**–†–∞—Å—à–∏—Ä–µ–Ω–∏—è:** pgvector 0.5+

**–§—É–Ω–∫—Ü–∏–∏:**
- –•—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞–Ω–∏–π
- –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ (HNSW –∏–Ω–¥–µ–∫—Å—ã)
- ACID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –∏ –±—ç–∫–∞–ø—ã

### 3. Embeddings Service

**–ú–æ–¥–µ–ª–∏ (–Ω–∞ –≤—ã–±–æ—Ä):**
- **ruBERT** (–ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ —á–µ—Ä–µ–∑ API)
- **sberGPT embeddings** (—á–µ—Ä–µ–∑ SberDevices API)
- **Fallback:** OpenAI embeddings (text-embedding-3-small)

**–§—É–Ω–∫—Ü–∏–∏:**
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–µ–∫—Ç–æ—Ä–æ–≤ –¥–ª—è —Ç–µ–∫—Å—Ç–∞ (1536 –∏–∑–º–µ—Ä–µ–Ω–∏–π)
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ embeddings
- Batch processing –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤

### 4. Integration Layer (n8n)

**Workflows:**

1. **User Query ‚Üí Writer ‚Üí Expert ‚Üí Response**
   ```
   User: "–ù–∞–ø–∏—à–∏ —Ä–∞–∑–¥–µ–ª '–¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞'"
   ‚îÇ
   ‚ñº
   n8n: –í—ã–∑–æ–≤ Writer Agent
   ‚îÇ
   ‚ñº
   Writer: –ó–∞–ø—Ä–æ—Å –∫ Expert "–ö–∞–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ü–µ–ª—è–º?"
   ‚îÇ
   ‚ñº
   Expert: –ü–æ–∏—Å–∫ –≤ –ë–î ‚Üí –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ ‚Üí –û—Ç–≤–µ—Ç
   ‚îÇ
   ‚ñº
   Writer: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —Å —É—á–µ—Ç–æ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
   ‚îÇ
   ‚ñº
   n8n: –í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ User
   ```

2. **Scheduled Update ‚Üí Researcher ‚Üí Expert ‚Üí DB**
   ```
   Cron Job (–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ)
   ‚îÇ
   ‚ñº
   Expert: "–ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –§–ü–ì"
   ‚îÇ
   ‚ñº
   Expert ‚Üí Researcher: "–°–æ–±–µ—Ä–∏ –Ω–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å —Å–∞–π—Ç–∞ –§–ü–ì"
   ‚îÇ
   ‚ñº
   Researcher: –ü–∞—Ä—Å–∏–Ω–≥ —Å–∞–π—Ç–∞, –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤
   ‚îÇ
   ‚ñº
   Researcher ‚Üí Expert: "–í–æ—Ç –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ"
   ‚îÇ
   ‚ñº
   Expert: –í–∞–ª–∏–¥–∞—Ü–∏—è ‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î ‚Üí –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ embeddings
   ‚îÇ
   ‚ñº
   Expert: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
   ```

---

## –ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö

### Schema Design

#### 1. `knowledge_sources` - –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

```sql
CREATE TABLE knowledge_sources (
    id SERIAL PRIMARY KEY,
    fund_name VARCHAR(100) NOT NULL,           -- 'fpg', 'kultura', 'rosmolodjezh'
    source_type VARCHAR(50) NOT NULL,          -- 'official_article', 'example', 'methodical'
    title TEXT NOT NULL,                       -- "–°—Ç–∞—Ç—å—è 84. –†–∞–∑–¥–µ–ª –û –ø—Ä–æ–µ–∫—Ç–µ"
    url TEXT,                                   -- https://...
    downloaded_at TIMESTAMP DEFAULT NOW(),
    version VARCHAR(20),                        -- '2025', '2024'
    is_active BOOLEAN DEFAULT true,             -- –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∞
    metadata JSONB,                             -- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_sources_fund ON knowledge_sources(fund_name);
CREATE INDEX idx_sources_active ON knowledge_sources(is_active);
CREATE INDEX idx_sources_type ON knowledge_sources(source_type);
```

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø–∏—Å–µ–π:**
```sql
INSERT INTO knowledge_sources (fund_name, source_type, title, url, version) VALUES
('fpg', 'official_article', '–°—Ç–∞—Ç—å—è 84. –†–∞–∑–¥–µ–ª –û –ø—Ä–æ–µ–∫—Ç–µ', 'https://–ø—Ä–µ–∑–∏–¥–µ–Ω—Ç—Å–∫–∏–µ–≥—Ä–∞–Ω—Ç—ã.—Ä—Ñ/...', '2025'),
('fpg', 'official_article', '–°—Ç–∞—Ç—å—è 86. –†–∞–∑–¥–µ–ª –ö–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–µ–∫—Ç–∞', 'https://...', '2025'),
('fpg', 'example', '–£—Å–ø–µ—à–Ω–∞—è –∑–∞—è–≤–∫–∞ ‚Ññ123456 (2021)', null, '2021');
```

#### 2. `knowledge_sections` - –†–∞–∑–¥–µ–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

```sql
CREATE TABLE knowledge_sections (
    id SERIAL PRIMARY KEY,
    source_id INTEGER REFERENCES knowledge_sources(id) ON DELETE CASCADE,
    section_type VARCHAR(50) NOT NULL,         -- 'requirement', 'example', 'tip', 'criterion'
    section_name TEXT NOT NULL,                -- "–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞", "–ë—é–¥–∂–µ—Ç", "–ö–æ–º–∞–Ω–¥–∞"
    content TEXT NOT NULL,                     -- –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç —Ä–∞–∑–¥–µ–ª–∞
    char_limit INTEGER,                        -- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å)
    priority INTEGER DEFAULT 5,                -- 1-10, –≤–∞–∂–Ω–æ—Å—Ç—å —Ä–∞–∑–¥–µ–ª–∞
    metadata JSONB,                            -- –î–æ–ø. –¥–∞–Ω–Ω—ã–µ
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_sections_source ON knowledge_sections(source_id);
CREATE INDEX idx_sections_type ON knowledge_sections(section_type);
CREATE INDEX idx_sections_name ON knowledge_sections(section_name);
```

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø–∏—Å–µ–π:**
```sql
INSERT INTO knowledge_sections (source_id, section_type, section_name, content, char_limit, priority) VALUES
(1, 'requirement', '–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞', '–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∫—Ä–∞—Ç–∫–∏–º...', 300, 10),
(1, 'requirement', '–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏', '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–ø–∏—Å–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É...', 5000, 10),
(3, 'example', '–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ (–ø—Ä–∏–º–µ—Ä)', '–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ...', NULL, 7);
```

#### 3. `successful_examples` - –ü—Ä–∏–º–µ—Ä—ã —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞—è–≤–æ–∫

```sql
CREATE TABLE successful_examples (
    id SERIAL PRIMARY KEY,
    fund_name VARCHAR(100) NOT NULL,
    application_number VARCHAR(50),            -- –ù–æ–º–µ—Ä –∑–∞—è–≤–∫–∏
    year INTEGER NOT NULL,                     -- –ì–æ–¥ –ø–æ–±–µ–¥—ã
    direction VARCHAR(200),                    -- –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—É—Ä—Å–∞
    requested_amount DECIMAL(12, 2),           -- –ó–∞–ø—Ä–æ—à–µ–Ω–Ω–∞—è —Å—É–º–º–∞
    cofinancing_amount DECIMAL(12, 2),         -- –°–æ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ
    status VARCHAR(50) DEFAULT 'winner',       -- 'winner', 'finalist'
    full_text TEXT,                            -- –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –∑–∞—è–≤–∫–∏
    extracted_parts JSONB,                     -- –ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_examples_fund ON successful_examples(fund_name);
CREATE INDEX idx_examples_year ON successful_examples(year);
CREATE INDEX idx_examples_direction ON successful_examples(direction);
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ `extracted_parts` JSONB:**
```json
{
  "project_name": "–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞ –¥–ª—è —à–∫–æ–ª—å–Ω–∏–∫–æ–≤",
  "goals": "–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ...",
  "tasks": ["–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É", "–ü—Ä–æ–≤–µ—Å—Ç–∏ –Ω–∞–±–æ—Ä", ...],
  "target_group": "–°—Ç–∞—Ä—à–µ–∫–ª–∞—Å—Å–Ω–∏–∫–∏ 10-11 –∫–ª–∞—Å—Å–æ–≤ –≥–æ—Ä–æ–¥–∞ –°–∞—Ä–∞–ø—É–ª",
  "budget": {
    "total": 500000,
    "by_category": {...}
  },
  "team": [...]
}
```

#### 4. `evaluation_criteria` - –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏

```sql
CREATE TABLE evaluation_criteria (
    id SERIAL PRIMARY KEY,
    fund_name VARCHAR(100) NOT NULL,
    criterion_number INTEGER,                  -- 1-10 –¥–ª—è –§–ü–ì
    criterion_name VARCHAR(200) NOT NULL,
    max_score INTEGER NOT NULL,                -- –ú–∞–∫—Å. –±–∞–ª–ª–æ–≤ (–æ–±—ã—á–Ω–æ 10)
    description TEXT NOT NULL,                 -- –ß—Ç–æ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è
    examples TEXT,                             -- –ü—Ä–∏–º–µ—Ä—ã —Ö–æ—Ä–æ—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫
    tips TEXT,                                 -- –°–æ–≤–µ—Ç—ã –¥–ª—è –∑–∞—è–≤–∏—Ç–µ–ª–µ–π
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_criteria_fund ON evaluation_criteria(fund_name);
CREATE INDEX idx_criteria_number ON evaluation_criteria(criterion_number);
```

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø–∏—Å–µ–π:**
```sql
INSERT INTO evaluation_criteria (fund_name, criterion_number, criterion_name, max_score, description) VALUES
('fpg', 1, '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', 10, '–û—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ —Å–∞–π—Ç–∞, —Å–æ—Ü—Å–µ—Ç–µ–π...'),
('fpg', 2, '–û–ø—ã—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º', 10, '–û–ø—ã—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ—Ö–æ–∂–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤...'),
('fpg', 4, '–ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –∏ —Å–æ—Ü–∏–∞–ª—å–Ω–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å', 10, '–û–±–æ—Å–Ω–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã...');
```

#### 5. `knowledge_embeddings` - –í–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è

```sql
CREATE EXTENSION IF NOT EXISTS vector;

CREATE TABLE knowledge_embeddings (
    id SERIAL PRIMARY KEY,
    section_id INTEGER REFERENCES knowledge_sections(id) ON DELETE CASCADE,
    embedding vector(1536),                    -- –í–µ–∫—Ç–æ—Ä 1536 –∏–∑–º–µ—Ä–µ–Ω–∏–π
    model_name VARCHAR(50) DEFAULT 'rubert',   -- 'rubert', 'sbergpt', 'openai'
    created_at TIMESTAMP DEFAULT NOW()
);

-- HNSW –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
CREATE INDEX idx_embeddings_hnsw ON knowledge_embeddings
USING hnsw (embedding vector_cosine_ops)
WITH (m = 16, ef_construction = 64);

CREATE INDEX idx_embeddings_section ON knowledge_embeddings(section_id);
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```python
# 1. –°–æ–∑–¥–∞–Ω–∏–µ embedding –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞
section_text = "–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∫—Ä–∞—Ç–∫–∏–º..."
embedding = embedding_service.get_embedding(section_text)  # [0.123, -0.456, ...]

# 2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
INSERT INTO knowledge_embeddings (section_id, embedding, model_name)
VALUES (42, embedding, 'rubert')

# 3. –ü–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö —Ä–∞–∑–¥–µ–ª–æ–≤
query = "–ö–∞–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –Ω–∞–∑–≤–∞–Ω–∏—é?"
query_embedding = embedding_service.get_embedding(query)

SELECT ks.*, ke.embedding <=> query_embedding AS distance
FROM knowledge_sections ks
JOIN knowledge_embeddings ke ON ke.section_id = ks.id
ORDER BY distance
LIMIT 5;
```

#### 6. `knowledge_updates` - –ò—Å—Ç–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

```sql
CREATE TABLE knowledge_updates (
    id SERIAL PRIMARY KEY,
    updated_by VARCHAR(50) NOT NULL,           -- 'expert_agent', 'researcher', 'admin'
    update_type VARCHAR(50) NOT NULL,          -- 'new', 'modified', 'deleted', 'bulk_import'
    description TEXT,                          -- –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
    affected_tables TEXT[],                    -- ['knowledge_sections', 'successful_examples']
    record_ids INTEGER[],                      -- IDs –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
    metadata JSONB,                            -- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_updates_by ON knowledge_updates(updated_by);
CREATE INDEX idx_updates_type ON knowledge_updates(update_type);
CREATE INDEX idx_updates_date ON knowledge_updates(created_at);
```

**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```sql
-- –õ–æ–≥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Researcher
INSERT INTO knowledge_updates (updated_by, update_type, description, affected_tables, record_ids) VALUES
('researcher', 'new', '–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –§–ü–ì 2025',
 ARRAY['knowledge_sources', 'knowledge_sections'],
 ARRAY[101, 102, 103]);

-- –õ–æ–≥ —É–¥–∞–ª–µ–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤—à–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
INSERT INTO knowledge_updates (updated_by, update_type, description) VALUES
('admin', 'deleted', '–£–¥–∞–ª–µ–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –§–ü–ì 2023 (—É—Å—Ç–∞—Ä–µ–ª–∏)');
```

### Database Views (–¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞)

```sql
-- View: –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —Å embeddings
CREATE VIEW v_active_knowledge AS
SELECT
    ks.id,
    ks.fund_name,
    ks.section_name,
    ks.content,
    ks.char_limit,
    ke.embedding,
    src.title AS source_title,
    src.url AS source_url
FROM knowledge_sections ks
JOIN knowledge_sources src ON src.id = ks.source_id
LEFT JOIN knowledge_embeddings ke ON ke.section_id = ks.id
WHERE src.is_active = true;

-- View: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ñ–æ–Ω–¥–∞–º
CREATE VIEW v_knowledge_stats AS
SELECT
    fund_name,
    COUNT(DISTINCT id) AS total_sources,
    COUNT(DISTINCT CASE WHEN is_active THEN id END) AS active_sources,
    MAX(updated_at) AS last_update
FROM knowledge_sources
GROUP BY fund_name;
```

---

## Expert Agent –ö–ª–∞—Å—Å

### Python Implementation

```python
# expert_agent/expert_agent.py

import asyncpg
from typing import List, Dict, Optional
import numpy as np
from datetime import datetime

class ExpertAgent:
    """
    –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∞–≥–µ–Ω—Ç-—ç–∫—Å–ø–µ—Ä—Ç –ø–æ –≥—Ä–∞–Ω—Ç–∞–º
    –£–ø—Ä–∞–≤–ª—è–µ—Ç –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π –∏ –æ–±—É—á–∞–µ—Ç –¥—Ä—É–≥–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤
    """

    def __init__(self, db_pool: asyncpg.Pool, embeddings_service, llm_client):
        """
        Args:
            db_pool: Connection pool –∫ PostgreSQL
            embeddings_service: –°–µ—Ä–≤–∏—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ embeddings (ruBERT/sberGPT)
            llm_client: –ö–ª–∏–µ–Ω—Ç –¥–ª—è LLM (GigaChat, OpenAI, etc.)
        """
        self.db = db_pool
        self.embeddings = embeddings_service
        self.llm = llm_client

    async def query_knowledge(
        self,
        question: str,
        fund: str = 'fpg',
        top_k: int = 5,
        min_similarity: float = 0.75
    ) -> Dict:
        """
        –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π

        Args:
            question: –í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            fund: –§–æ–Ω–¥ ('fpg', 'kultura', etc.)
            top_k: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤
            min_similarity: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ö–æ–∂–µ—Å—Ç—å (0-1)

        Returns:
            {
                'answer': str,
                'sources': List[int],
                'confidence': float,
                'relevant_sections': List[Dict]
            }
        """
        # 1. –°–æ–∑–¥–∞—Ç—å embedding –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞
        question_embedding = await self.embeddings.get_embedding(question)

        # 2. –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –≤ –ë–î
        relevant_sections = await self._vector_search(
            question_embedding,
            fund,
            top_k,
            min_similarity
        )

        if not relevant_sections:
            return {
                'answer': '–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –Ω–µ –Ω–∞—à–µ–ª —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π.',
                'sources': [],
                'confidence': 0.0,
                'relevant_sections': []
            }

        # 3. –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è LLM
        context = self._build_context(relevant_sections)

        # 4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ LLM
        answer = await self.llm.generate(
            system_prompt=f"–¢—ã —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –≥—Ä–∞–Ω—Ç–æ–≤—ã–º –∑–∞—è–≤–∫–∞–º —Ñ–æ–Ω–¥–∞ {fund.upper()}.",
            context=context,
            question=question
        )

        # 5. –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
        confidence = self._calculate_confidence(relevant_sections)

        return {
            'answer': answer,
            'sources': [s['id'] for s in relevant_sections],
            'confidence': confidence,
            'relevant_sections': relevant_sections
        }

    async def _vector_search(
        self,
        query_embedding: np.ndarray,
        fund: str,
        top_k: int,
        min_similarity: float
    ) -> List[Dict]:
        """–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö —Ä–∞–∑–¥–µ–ª–æ–≤"""

        query = """
        SELECT
            ks.id,
            ks.section_name,
            ks.content,
            ks.char_limit,
            ks.priority,
            src.title AS source_title,
            src.url AS source_url,
            1 - (ke.embedding <=> $1::vector) AS similarity
        FROM knowledge_sections ks
        JOIN knowledge_sources src ON src.id = ks.source_id
        JOIN knowledge_embeddings ke ON ke.section_id = ks.id
        WHERE
            src.fund_name = $2
            AND src.is_active = true
            AND (1 - (ke.embedding <=> $1::vector)) >= $3
        ORDER BY ke.embedding <=> $1::vector
        LIMIT $4
        """

        async with self.db.acquire() as conn:
            rows = await conn.fetch(
                query,
                query_embedding.tolist(),
                fund,
                min_similarity,
                top_k
            )

        return [dict(row) for row in rows]

    def _build_context(self, sections: List[Dict]) -> str:
        """–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è LLM –∏–∑ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤"""
        context_parts = []

        for i, section in enumerate(sections, 1):
            context_parts.append(f"""
**–ò—Å—Ç–æ—á–Ω–∏–∫ {i}:** {section['source_title']}
**–†–∞–∑–¥–µ–ª:** {section['section_name']}
**–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å:** {section['similarity']:.2%}
{section['content']}
            """.strip())

        return "\n\n---\n\n".join(context_parts)

    def _calculate_confidence(self, sections: List[Dict]) -> float:
        """–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –æ—Ç–≤–µ—Ç–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ similarity scores"""
        if not sections:
            return 0.0

        # –°—Ä–µ–¥–Ω—è—è similarity —Å –≤–µ—Å–æ–º –Ω–∞ top-1
        top_similarity = sections[0]['similarity']
        avg_similarity = np.mean([s['similarity'] for s in sections])

        # Weighted average (60% top-1, 40% average)
        confidence = 0.6 * top_similarity + 0.4 * avg_similarity

        return round(confidence, 3)

    async def train_agent(
        self,
        agent_name: str,
        fund: str = 'fpg',
        section: Optional[str] = None
    ) -> Dict:
        """
        –î–æ–æ–±—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ë–ó
        –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –∞–≥–µ–Ω—Ç–∞

        Args:
            agent_name: 'writer', 'reviewer', 'researcher', 'interviewer'
            fund: –§–æ–Ω–¥
            section: –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

        Returns:
            {
                'status': 'success',
                'updated_prompt': str,
                'knowledge_items': int,
                'version': str
            }
        """
        # 1. –ü–æ–ª—É—á–∏—Ç—å –∑–Ω–∞–Ω–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
        if agent_name == 'writer':
            knowledge = await self._get_writer_knowledge(fund, section)
        elif agent_name == 'reviewer':
            knowledge = await self._get_reviewer_knowledge(fund)
        elif agent_name == 'researcher':
            knowledge = await self._get_researcher_knowledge(fund)
        elif agent_name == 'interviewer':
            knowledge = await self._get_interviewer_knowledge(fund)
        else:
            raise ValueError(f"Unknown agent: {agent_name}")

        # 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å training data
        training_data = self._prepare_training_data(knowledge, agent_name)

        # 3. –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–º–ø—Ç –∞–≥–µ–Ω—Ç–∞ (—á–µ—Ä–µ–∑ n8n API –∏–ª–∏ —Ñ–∞–π–ª)
        version = datetime.now().strftime('%Y-%m-%d_v1')
        updated_prompt = await self._update_agent_prompt(
            agent_name,
            training_data,
            version
        )

        return {
            'status': 'success',
            'updated_prompt': updated_prompt,
            'knowledge_items': len(knowledge),
            'version': version
        }

    async def _get_writer_knowledge(self, fund: str, section: Optional[str]) -> List[Dict]:
        """–ü–æ–ª—É—á–∏—Ç—å –∑–Ω–∞–Ω–∏—è –¥–ª—è Writer –∞–≥–µ–Ω—Ç–∞"""
        query = """
        SELECT
            ks.section_name,
            ks.content,
            ks.char_limit,
            ks.priority,
            src.title
        FROM knowledge_sections ks
        JOIN knowledge_sources src ON src.id = ks.source_id
        WHERE
            src.fund_name = $1
            AND src.is_active = true
            AND ks.section_type IN ('requirement', 'example', 'tip')
        """

        if section:
            query += " AND ks.section_name = $2"
            params = [fund, section]
        else:
            params = [fund]

        query += " ORDER BY ks.priority DESC, ks.section_name"

        async with self.db.acquire() as conn:
            rows = await conn.fetch(query, *params)

        return [dict(row) for row in rows]

    async def _get_reviewer_knowledge(self, fund: str) -> List[Dict]:
        """–ü–æ–ª—É—á–∏—Ç—å –∑–Ω–∞–Ω–∏—è –¥–ª—è Reviewer –∞–≥–µ–Ω—Ç–∞ (–∫—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏)"""
        query = """
        SELECT
            criterion_number,
            criterion_name,
            max_score,
            description,
            examples,
            tips
        FROM evaluation_criteria
        WHERE fund_name = $1
        ORDER BY criterion_number
        """

        async with self.db.acquire() as conn:
            rows = await conn.fetch(query, fund)

        return [dict(row) for row in rows]

    def _prepare_training_data(self, knowledge: List[Dict], agent_name: str) -> str:
        """–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å training data –¥–ª—è –∞–≥–µ–Ω—Ç–∞"""

        if agent_name == 'writer':
            # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è Writer
            sections = []
            for item in knowledge:
                section = f"### {item['section_name']}\n"
                if item['char_limit']:
                    section += f"**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** {item['char_limit']} —Å–∏–º–≤–æ–ª–æ–≤\n"
                section += f"{item['content']}\n"
                sections.append(section)

            return "\n".join(sections)

        elif agent_name == 'reviewer':
            # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è Reviewer
            criteria = []
            for item in knowledge:
                criterion = f"""
**–ö—Ä–∏—Ç–µ—Ä–∏–π {item['criterion_number']}: {item['criterion_name']}**
–ú–∞–∫—Å–∏–º—É–º –±–∞–ª–ª–æ–≤: {item['max_score']}
–û–ø–∏—Å–∞–Ω–∏–µ: {item['description']}
                """.strip()
                if item['tips']:
                    criterion += f"\n–°–æ–≤–µ—Ç—ã: {item['tips']}"
                criteria.append(criterion)

            return "\n\n".join(criteria)

        # TODO: –î—Ä—É–≥–∏–µ –∞–≥–µ–Ω—Ç—ã
        return ""

    async def _update_agent_prompt(
        self,
        agent_name: str,
        training_data: str,
        version: str
    ) -> str:
        """–û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–º–ø—Ç –∞–≥–µ–Ω—Ç–∞"""
        # TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å n8n –∏–ª–∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π
        # –ù–∞–ø—Ä–∏–º–µ—Ä, –æ–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª .claude/agents/{agent_name}.md

        updated_prompt = f"""
# {agent_name.title()} Agent

**–í–µ—Ä—Å–∏—è:** {version}
**–û–±–Ω–æ–≤–ª–µ–Ω–æ Expert Agent:** {datetime.now().isoformat()}

## –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

{training_data}

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

[... –æ—Å—Ç–∞–ª—å–Ω–æ–π –ø—Ä–æ–º–ø—Ç –∞–≥–µ–Ω—Ç–∞ ...]
        """.strip()

        return updated_prompt

    async def update_knowledge(
        self,
        topic: str,
        fund: str = 'fpg',
        trigger: str = 'manual'
    ) -> Dict:
        """
        –û–±–Ω–æ–≤–∏—Ç—å –∑–Ω–∞–Ω–∏—è —á–µ—Ä–µ–∑ Researcher –∞–≥–µ–Ω—Ç–∞

        Args:
            topic: –¢–µ–º–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            fund: –§–æ–Ω–¥
            trigger: 'manual', 'scheduled', 'auto'

        Returns:
            {
                'status': 'success',
                'sections_added': int,
                'sections_updated': int
            }
        """
        # 1. –í—ã–∑–≤–∞—Ç—å Researcher –∞–≥–µ–Ω—Ç–∞
        new_info = await self._call_researcher_agent(topic, fund)

        if not new_info:
            return {'status': 'no_data', 'message': 'Researcher –Ω–µ –Ω–∞—à–µ–ª –Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏'}

        # 2. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
        validation_result = await self._validate_information(new_info)
        if not validation_result['is_valid']:
            return {
                'status': 'rejected',
                'reason': validation_result['reason']
            }

        # 3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î
        sections_added, sections_updated = await self._save_knowledge(new_info, fund)

        # 4. –°–æ–∑–¥–∞—Ç—å embeddings –¥–ª—è –Ω–æ–≤—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤
        await self._create_embeddings_for_new_sections(sections_added)

        # 5. –ó–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
        await self._log_update('researcher', 'new', f'Updated {topic}', sections_added)

        return {
            'status': 'success',
            'sections_added': len(sections_added),
            'sections_updated': len(sections_updated)
        }

    async def _call_researcher_agent(self, topic: str, fund: str) -> Dict:
        """–í—ã–∑–≤–∞—Ç—å Researcher –∞–≥–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ n8n"""
        # TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—ã–∑–æ–≤ n8n webhook
        # POST https://n8n.example.com/webhook/researcher
        # {
        #     "task": "fetch_requirements",
        #     "fund": "fpg",
        #     "topic": topic
        # }
        pass

    async def _validate_information(self, info: Dict) -> Dict:
        """–í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é"""
        # –ü—Ä–æ–≤–µ—Ä–∫–∏:
        # 1. –ï—Å—Ç—å –ª–∏ —Ç–µ–∫—Å—Ç?
        # 2. –£–∫–∞–∑–∞–Ω –ª–∏ –∏—Å—Ç–æ—á–Ω–∏–∫ (URL)?
        # 3. –ù–µ –¥—É–±–ª–∏–∫–∞—Ç –ª–∏?
        # 4. –ö–∞—á–µ—Å—Ç–≤–æ —Ç–µ–∫—Å—Ç–∞ (—á–µ—Ä–µ–∑ LLM?)

        if not info.get('content'):
            return {'is_valid': False, 'reason': 'No content'}

        if not info.get('source_url'):
            return {'is_valid': False, 'reason': 'No source URL'}

        # TODO: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã

        return {'is_valid': True}

    async def _save_knowledge(self, info: Dict, fund: str) -> tuple:
        """–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–Ω–∞–Ω–∏—è –≤ –ë–î"""
        sections_added = []
        sections_updated = []

        async with self.db.acquire() as conn:
            # 1. –°–æ–∑–¥–∞—Ç—å/–Ω–∞–π—Ç–∏ source
            source_id = await conn.fetchval("""
                INSERT INTO knowledge_sources (fund_name, source_type, title, url, version)
                VALUES ($1, $2, $3, $4, $5)
                ON CONFLICT (url) DO UPDATE SET updated_at = NOW()
                RETURNING id
            """, fund, info['source_type'], info['title'], info['source_url'], info['version'])

            # 2. –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª—ã
            for section in info['sections']:
                section_id = await conn.fetchval("""
                    INSERT INTO knowledge_sections
                    (source_id, section_type, section_name, content, char_limit, priority)
                    VALUES ($1, $2, $3, $4, $5, $6)
                    RETURNING id
                """, source_id, section['type'], section['name'],
                   section['content'], section.get('char_limit'), section.get('priority', 5))

                sections_added.append(section_id)

        return sections_added, sections_updated

    async def _create_embeddings_for_new_sections(self, section_ids: List[int]):
        """–°–æ–∑–¥–∞—Ç—å embeddings –¥–ª—è –Ω–æ–≤—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤"""
        async with self.db.acquire() as conn:
            for section_id in section_ids:
                # –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—Å—Ç
                content = await conn.fetchval(
                    "SELECT content FROM knowledge_sections WHERE id = $1",
                    section_id
                )

                # –°–æ–∑–¥–∞—Ç—å embedding
                embedding = await self.embeddings.get_embedding(content)

                # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                await conn.execute("""
                    INSERT INTO knowledge_embeddings (section_id, embedding, model_name)
                    VALUES ($1, $2, $3)
                """, section_id, embedding.tolist(), 'rubert')

    async def _log_update(
        self,
        updated_by: str,
        update_type: str,
        description: str,
        record_ids: List[int]
    ):
        """–ó–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ knowledge_updates"""
        async with self.db.acquire() as conn:
            await conn.execute("""
                INSERT INTO knowledge_updates
                (updated_by, update_type, description, affected_tables, record_ids)
                VALUES ($1, $2, $3, $4, $5)
            """, updated_by, update_type, description,
               ['knowledge_sections'], record_ids)
```

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ê–≥–µ–Ω—Ç–∞–º–∏

### 1. Writer Agent Integration

**–°—Ç–∞—Ä—ã–π workflow (–±–µ–∑ Expert):**
```
User: "–ù–∞–ø–∏—à–∏ —Ä–∞–∑–¥–µ–ª '–¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞'"
‚îÇ
‚ñº
Writer: –ß–∏—Ç–∞–µ—Ç UNIFIED_KNOWLEDGE_BASE.md (–≤–µ—Å—å —Ñ–∞–π–ª 329 KB)
‚îÇ
‚ñº
Writer: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ markdown
‚îÇ
‚ñº
User: –ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—Å—Ç
```

**–ù–æ–≤—ã–π workflow (—Å Expert):**
```
User: "–ù–∞–ø–∏—à–∏ —Ä–∞–∑–¥–µ–ª '–¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞'"
‚îÇ
‚ñº
Writer: –ó–∞–ø—Ä–æ—Å –∫ Expert "–ö–∞–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ü–µ–ª—è–º –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è –§–ü–ì?"
‚îÇ
‚ñº
Expert: –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ ‚Üí –ù–∞—Ö–æ–¥–∏—Ç 5 —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤
‚îÇ
‚ñº
Expert: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–µ (5-10 KB –≤–º–µ—Å—Ç–æ 329 KB)
‚îÇ
‚ñº
Writer: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç —Å —É—á–µ—Ç–æ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
‚îÇ
‚ñº
User: –ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—Å—Ç
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚ö° –ë—ã—Å—Ç—Ä–µ–µ (–º–µ–Ω—å—à–µ —Ç–æ–∫–µ–Ω–æ–≤)
- üìä –ê–∫—Ç—É–∞–ª—å–Ω–µ–µ (–ë–î –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- üéØ –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–µ–µ (—Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)

### 2. Reviewer Agent Integration

**–ó–∞–¥–∞—á–∞ Reviewer:** –û—Ü–µ–Ω–∏—Ç—å –∑–∞—è–≤–∫—É –ø–æ 10 –∫—Ä–∏—Ç–µ—Ä–∏—è–º –§–ü–ì

**–° Expert Agent:**
```
Reviewer: "–î–∞–π –º–Ω–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏ –¥–ª—è –§–ü–ì"
‚îÇ
‚ñº
Expert: SELECT * FROM evaluation_criteria WHERE fund_name = 'fpg'
‚îÇ
‚ñº
Expert: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç 10 –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏ –∏ —Å–æ–≤–µ—Ç–∞–º–∏
‚îÇ
‚ñº
Reviewer: –û—Ü–µ–Ω–∏–≤–∞–µ—Ç –∑–∞—è–≤–∫—É –ø–æ –∫–∞–∂–¥–æ–º—É –∫—Ä–∏—Ç–µ—Ä–∏—é
‚îÇ
‚ñº
Reviewer: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ü–µ–Ω–∫–∏ + —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
```

### 3. Researcher Agent Integration (–¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è!)

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: Expert –≤—ã–∑—ã–≤–∞–µ—Ç Researcher**
```
Cron Job: –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
‚îÇ
‚ñº
Expert: "–ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –§–ü–ì –Ω–∞ 2025 –≥–æ–¥"
‚îÇ
‚ñº
Expert ‚Üí Researcher: "–°–æ–±–µ—Ä–∏ –Ω–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å —Å–∞–π—Ç–∞ –§–ü–ì"
‚îÇ
‚ñº
Researcher: –ü–∞—Ä—Å–∏—Ç —Å–∞–π—Ç, –∏–∑–≤–ª–µ–∫–∞–µ—Ç –Ω–æ–≤—ã–µ —Å—Ç–∞—Ç—å–∏
‚îÇ
‚ñº
Researcher ‚Üí Expert: "–í–æ—Ç –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ [...]"
‚îÇ
‚ñº
Expert: –í–∞–ª–∏–¥–∞—Ü–∏—è ‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î ‚Üí Embeddings
```

**–°—Ü–µ–Ω–∞—Ä–∏–π 2: Researcher –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Expert**
```
User: "–ù–∞–π–¥–∏ –ø—Ä–∏–º–µ—Ä—ã —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞—è–≤–æ–∫ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ'"
‚îÇ
‚ñº
Researcher: –ó–∞–ø—Ä–æ—Å –∫ Expert "–ü—Ä–∏–º–µ—Ä—ã –∑–∞—è–≤–æ–∫ –ø–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é?"
‚îÇ
‚ñº
Expert: SELECT * FROM successful_examples WHERE direction LIKE '%–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ%'
‚îÇ
‚ñº
Expert: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç 3 –ø—Ä–∏–º–µ—Ä–∞
‚îÇ
‚ñº
Researcher: –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç User
```

### 4. Interviewer Agent Integration

**–ó–∞–¥–∞—á–∞ Interviewer:** –°–æ–±—Ä–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∑–∞—è–≤–∫–∏

**–° Expert Agent:**
```
Interviewer: "–ö–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –∑–∞–¥–∞—Ç—å –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞ '–û –ø—Ä–æ–µ–∫—Ç–µ'?"
‚îÇ
‚ñº
Expert: –ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ required –ø–æ–ª—è —Ä–∞–∑–¥–µ–ª–∞ "–û –ø—Ä–æ–µ–∫—Ç–µ"
‚îÇ
‚ñº
Expert: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫:
  - –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ (–º–∞–∫—Å 300 —Å–∏–º–≤–æ–ª–æ–≤)
  - –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ (–º–∞–∫—Å 5000 —Å–∏–º–≤–æ–ª–æ–≤)
  - –¶–µ–ª–µ–≤–∞—è –≥—Ä—É–ø–ø–∞
  - ...
‚îÇ
‚ñº
Interviewer: –ó–∞–¥–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ —Å–ø–∏—Å–∫—É
‚îÇ
‚ñº
Interviewer: –°–æ–±–∏—Ä–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã
```

---

## Workflow –∏ –ü—Ä–æ—Ü–µ—Å—Å—ã

### Process 1: User Query Flow

```mermaid
graph TD
    A[User sends message] -->|Telegram| B[n8n Webhook]
    B --> C{Intent?}
    C -->|Write| D[Writer Agent]
    C -->|Review| E[Reviewer Agent]
    C -->|Research| F[Researcher Agent]

    D --> G[Query Expert Agent]
    E --> G
    F --> G

    G --> H[Vector Search in PostgreSQL]
    H --> I[Return relevant knowledge]
    I --> D
    I --> E
    I --> F

    D --> J[Generate response]
    E --> J
    F --> J

    J -->|n8n| K[Telegram Bot]
    K --> L[User receives response]
```

### Process 2: Knowledge Update Flow

```mermaid
graph TD
    A[Cron Job: Weekly] --> B[Expert Agent]
    B --> C{Need update?}
    C -->|Yes| D[Call Researcher via n8n]
    C -->|No| Z[Skip]

    D --> E[Researcher: Fetch new data]
    E --> F[Researcher: Parse & Extract]
    F --> G[Researcher: Return to Expert]

    G --> H{Validate data}
    H -->|Valid| I[Save to PostgreSQL]
    H -->|Invalid| J[Reject & Log]

    I --> K[Create embeddings]
    K --> L[Update knowledge_embeddings]
    L --> M[Log in knowledge_updates]
    M --> N[Notify Admin]
```

### Process 3: Agent Training Flow

```mermaid
graph TD
    A[Admin: Request training] --> B[Expert Agent]
    B --> C{Which agent?}
    C -->|Writer| D[Get Writer knowledge]
    C -->|Reviewer| E[Get Reviewer knowledge]
    C -->|Other| F[Get specific knowledge]

    D --> G[Prepare training data]
    E --> G
    F --> G

    G --> H[Generate updated prompt]
    H --> I[Save to .claude/agents/]
    I --> J[Notify agent via n8n]
    J --> K[Agent reloads prompt]
```

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –°—Ç–µ–∫

### Backend

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|-----------|--------|-----------|
| Runtime | Python | 3.11+ | –û—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ |
| Web Framework | FastAPI | 0.104+ | REST API |
| DB Driver | asyncpg | 0.29+ | Async PostgreSQL |
| Embeddings | sentence-transformers | 2.2+ | ruBERT embeddings |
| Vector DB | pgvector | 0.5+ | –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ |
| LLM Client | openai / gigachat | latest | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ |
| Orchestration | n8n | self-hosted | Workflow |
| Queue | Celery + Redis | optional | Async tasks |

### Database

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|-----------|--------|-----------|
| –°–£–ë–î | PostgreSQL | 14+ | –û—Å–Ω–æ–≤–Ω–∞—è –ë–î |
| Extension | pgvector | 0.5+ | –í–µ–∫—Ç–æ—Ä—ã |
| Migration | Alembic | 1.12+ | –ú–∏–≥—Ä–∞—Ü–∏–∏ |
| Backup | pg_dump | native | –ë—ç–∫–∞–ø—ã |

### Infrastructure

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|-----------|-----------|
| Container | Docker | –ò–∑–æ–ª—è—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ |
| Orchestration | Docker Compose | –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ |
| CI/CD | GitHub Actions | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è |
| Monitoring | Prometheus + Grafana | –ú–µ—Ç—Ä–∏–∫–∏ |
| Logging | ELK Stack | –õ–æ–≥–∏ |

---

## 5-–≠—Ç–∞–ø–Ω—ã–π –ü–ª–∞–Ω –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: Database Schema (–Ω–µ–¥–µ–ª—è 1)

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å PostgreSQL –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

**–ó–∞–¥–∞—á–∏:**
1. ‚úÖ –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ö–µ–º—É –ë–î (6 —Ç–∞–±–ª–∏—Ü)
2. ‚è≥ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PostgreSQL 14+ –∏ pgvector
3. ‚è≥ –ù–∞–ø–∏—Å–∞—Ç—å SQL –º–∏–≥—Ä–∞—Ü–∏—é (DDL)
4. ‚è≥ –°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã (B-tree + HNSW)
5. ‚è≥ –ù–∞–ø–∏—Å–∞—Ç—å integration tests –¥–ª—è —Å—Ö–µ–º—ã

**Deliverables:**
- `schema.sql` - –ø–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞
- `001_initial_migration.sql` - Alembic –º–∏–≥—Ä–∞—Ü–∏—è
- `test_schema.py` - —Ç–µ—Å—Ç—ã

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:** –ë–î —Å–æ–∑–¥–∞–Ω–∞, –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –∏–Ω–¥–µ–∫—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç

---

### –≠—Ç–∞–ø 2: Data Migration (–Ω–µ–¥–µ–ª—è 2)

**–¶–µ–ª—å:** –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –ë–ó –∏–∑ markdown –≤ PostgreSQL

**–ó–∞–¥–∞—á–∏:**
1. ‚è≥ –ù–∞–ø–∏—Å–∞—Ç—å –ø–∞—Ä—Å–µ—Ä –¥–ª—è UNIFIED_KNOWLEDGE_BASE.md
2. ‚è≥ –°–æ–∑–¥–∞—Ç—å –º–∞–ø–ø–∏–Ω–≥: markdown ‚Üí SQL —Ç–∞–±–ª–∏—Ü—ã
3. ‚è≥ –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –§–ü–ì
4. ‚è≥ –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞—è–≤–æ–∫
5. ‚è≥ –°–æ–∑–¥–∞—Ç—å embeddings –¥–ª—è –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤
6. ‚è≥ –í–∞–ª–∏–¥–∞—Ü–∏—è: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π

**Deliverables:**
- `migrate_knowledge.py` - —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
- `create_embeddings.py` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–µ–∫—Ç–æ—Ä–æ–≤
- –ó–∞–ø–æ–ª–Ω–µ–Ω–Ω–∞—è –ë–î —Å ~100-150 —Ä–∞–∑–¥–µ–ª–∞–º–∏

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:** –í—Å–µ 329 KB –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î, embeddings —Å–æ–∑–¥–∞–Ω—ã

---

### –≠—Ç–∞–ø 3: Expert Agent Implementation (–Ω–µ–¥–µ–ª—è 3-4)

**–¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–π ExpertAgent –∫–ª–∞—Å—Å

**–ó–∞–¥–∞—á–∏:**
1. ‚è≥ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `ExpertAgent` –∫–ª–∞—Å—Å
2. ‚è≥ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `query_knowledge()` —Å –≤–µ–∫—Ç–æ—Ä–Ω—ã–º –ø–æ–∏—Å–∫–æ–º
3. ‚è≥ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `train_agent()` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–º–ø—Ç–æ–≤
4. ‚è≥ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å embeddings service (ruBERT)
5. ‚è≥ –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤
6. ‚è≥ –ù–∞–ø–∏—Å–∞—Ç—å integration-—Ç–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω–æ–π –ë–î
7. ‚è≥ –°–æ–∑–¥–∞—Ç—å FastAPI endpoints

**Deliverables:**
- `expert_agent.py` - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å
- `embeddings_service.py` - —Å–µ—Ä–≤–∏—Å embeddings
- `api.py` - FastAPI —Ä–æ—É—Ç—ã
- `test_expert_agent.py` - –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:** Expert –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é 80%+

---

### –≠—Ç–∞–ø 4: Writer Integration (–Ω–µ–¥–µ–ª—è 5)

**–¶–µ–ª—å:** –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Writer –∞–≥–µ–Ω—Ç–∞ —Å Expert

**–ó–∞–¥–∞—á–∏:**
1. ‚è≥ –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å n8n workflow –¥–ª—è Writer
2. ‚è≥ Writer –≤—ã–∑—ã–≤–∞–µ—Ç Expert –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
3. ‚è≥ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ Writer ‚Üí Expert
4. ‚è≥ A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: —Å—Ç–∞—Ä—ã–π vs –Ω–æ–≤—ã–π Writer
5. ‚è≥ –°—Ä–∞–≤–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤
6. ‚è≥ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**Deliverables:**
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π n8n workflow
- –õ–æ–≥–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (–¥–ª—è –∞–Ω–∞–ª–∏–∑–∞)
- –û—Ç—á–µ—Ç A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:** –ö–∞—á–µ—Å—Ç–≤–æ —Ç–µ–∫—Å—Ç–æ–≤ —É–ª—É—á—à–∏–ª–æ—Å—å –Ω–∞ 20%+

---

### –≠—Ç–∞–ø 5: Full Integration (–Ω–µ–¥–µ–ª—è 6-8)

**–¶–µ–ª—å:** –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤ –∏ –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

**–ó–∞–¥–∞—á–∏:**
1. ‚è≥ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Reviewer —Å Expert
2. ‚è≥ –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Researcher ‚Üî Expert
3. ‚è≥ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Interviewer —Å Expert
4. ‚è≥ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `update_knowledge()` —á–µ—Ä–µ–∑ Researcher
5. ‚è≥ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å cron job –¥–ª—è –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
6. ‚è≥ –°–æ–∑–¥–∞—Ç—å Web Admin –ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–ó
7. ‚è≥ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus + Grafana)
8. ‚è≥ –ù–∞–ø–∏—Å–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**Deliverables:**
- –í—Å–µ 4 –∞–≥–µ–Ω—Ç–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã
- Web Admin –ø–∞–Ω–µ–ª—å
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ dashboard
- User Guide + API docs

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:** –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω–æ, –æ–±–Ω–æ–≤–ª—è–µ—Ç –ë–ó

---

## –†–∏—Å–∫–∏ –∏ –ú–∏—Ç–∏–≥–∞—Ü–∏—è

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|---------|-----------|
| –ö–∞—á–µ—Å—Ç–≤–æ ruBERT embeddings –Ω–∏–∑–∫–æ–µ | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª–µ–π, fallback –Ω–∞ OpenAI |
| –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –º–µ–¥–ª–µ–Ω–Ω—ã–π | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | HNSW –∏–Ω–¥–µ–∫—Å—ã, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ |
| Researcher –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –Ω–æ–≤—É—é –∏–Ω—Ñ–æ | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | –£–ª—É—á—à–∏—Ç—å –ø–∞—Ä—Å–µ—Ä—ã, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API |
| –ë–î —Ä–∞–∑—Ä–∞—Å—Ç–∞–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ | –ù–∏–∑–∫–∞—è | –ù–∏–∑–∫–æ–µ | –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π |
| –°–ª–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å n8n | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | REST API, —á–µ—Ç–∫–∏–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç |

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≠—Ç–∞–ø–∞ 1 - —Å–æ–∑–¥–∞–Ω–∏–µ database schema

**–î–∞—Ç–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≠—Ç–∞–ø–∞ 1
