Отлично! Давайте проанализируем текущую админку и составим план реализации функционала для просмотра данных пользователей и прогресса заполнения анкет.

Сначала посмотрим на текущую структуру админки:

Ran tool
Посмотрим на основной файл админки:

Read file: GrantService/web-admin/main_admin.py
Теперь посмотрим на структуру базы данных:

Read file: GrantService/data/database.py
Теперь посмотрим на текущие функции админки:

Read file: GrantService/web-admin/main_admin.py
Отлично! Теперь у меня есть полное понимание текущего состояния. Давайте составим план реализации функционала для просмотра данных пользователей и прогресса заполнения анкет.

## �� **ПЛАН РЕАЛИЗАЦИИ: ПРОСМОТР ДАННЫХ ПОЛЬЗОВАТЕЛЕЙ И ПРОГРЕССА**

### **🎯 ТЕКУЩЕЕ СОСТОЯНИЕ:**

**✅ Что уже есть:**
- База данных с таблицами: `users`, `sessions`, `interview_questions`
- Админка на Streamlit с базовой аналитикой
- Управление вопросами интервью
- Система мониторинга

**❌ Что нужно добавить:**
- Детальный просмотр пользователей
- Прогресс заполнения анкет
- Блок с полученными данными
- Фильтрация и поиск

---

### **📊 ПЛАН РЕАЛИЗАЦИИ:**

#### **ЭТАП 1: Расширение базы данных** 🔧
**Время:** 1-2 часа

**Нужно добавить в таблицу `sessions`:**
```sql
-- Новые поля для отслеживания прогресса
ALTER TABLE sessions ADD COLUMN progress_percentage INTEGER DEFAULT 0;
ALTER TABLE sessions ADD COLUMN questions_answered INTEGER DEFAULT 0;
ALTER TABLE sessions ADD COLUMN total_questions INTEGER DEFAULT 24;
ALTER TABLE sessions ADD COLUMN last_question_number INTEGER DEFAULT 1;
ALTER TABLE sessions ADD COLUMN answers_data TEXT; -- JSON с ответами
ALTER TABLE sessions ADD COLUMN session_duration_minutes INTEGER DEFAULT 0;
ALTER TABLE sessions ADD COLUMN completion_status VARCHAR(20) DEFAULT 'in_progress';
```

**Новая таблица `user_answers`:**
```sql
CREATE TABLE user_answers (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    session_id INTEGER NOT NULL,
    question_id INTEGER NOT NULL,
    answer_text TEXT NOT NULL,
    answer_timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    validation_status VARCHAR(20) DEFAULT 'valid',
    FOREIGN KEY (session_id) REFERENCES sessions(id),
    FOREIGN KEY (question_id) REFERENCES interview_questions(id)
);
```

#### **ЭТАП 2: Новые функции в database.py** 🗄️
**Время:** 2-3 часа

**Добавить методы:**
```python
def get_user_sessions(telegram_id: int) -> List[Dict]:
    """Получить все сессии пользователя"""

def get_session_progress(session_id: int) -> Dict:
    """Получить прогресс заполнения сессии"""

def get_user_answers(session_id: int) -> List[Dict]:
    """Получить все ответы пользователя в сессии"""

def get_users_statistics() -> Dict:
    """Получить статистику по пользователям"""

def get_active_sessions() -> List[Dict]:
    """Получить активные сессии"""

def get_completed_sessions() -> List[Dict]:
    """Получить завершенные сессии"""
```

#### **ЭТАП 3: Новый раздел в админке** 🖥️
**Время:** 3-4 часа

**Добавить страницу "👥 Пользователи и прогресс":**

**Подразделы:**
1. **📊 Общая статистика**
   - Количество активных пользователей
   - Средний прогресс заполнения
   - Конверсия по этапам
   - Время заполнения анкет

2. **👤 Список пользователей**
   - Таблица с пользователями
   - Фильтры по статусу, дате регистрации
   - Поиск по имени/username
   - Экспорт в CSV

3. **�� Активные сессии**
   - Список незавершенных анкет
   - Прогресс в процентах
   - Время последней активности
   - Возможность отправить напоминание

4. **✅ Завершенные анкеты**
   - Список готовых заявок
   - Детальный просмотр ответов
   - Статус обработки
   - Экспорт данных

#### **ЭТАП 4: Детальный просмотр данных** 🔍
**Время:** 2-3 часа

**Функции для каждого пользователя:**
```python
def show_user_details(telegram_id: int):
    """Показать детальную информацию о пользователе"""
    
def show_session_progress(session_id: int):
    """Показать прогресс заполнения конкретной сессии"""
    
def show_user_answers(session_id: int):
    """Показать все ответы пользователя"""
    
def export_user_data(telegram_id: int):
    """Экспорт данных пользователя в PDF/CSV"""
```

#### **ЭТАП 5: Фильтры и поиск** 🔎
**Время:** 1-2 часа

**Фильтры:**
- По дате регистрации
- По статусу сессии (активная/завершенная)
- По прогрессу заполнения
- По времени последней активности
- По количеству сессий

**Поиск:**
- По имени пользователя
- По username
- По названию проекта
- По региону

#### **ЭТАП 6: Экспорт и отчеты** 📄
**Время:** 1-2 часа

**Функции экспорта:**
- Экспорт списка пользователей в CSV
- Экспорт ответов конкретного пользователя
- Генерация отчета по прогрессу
- Экспорт статистики в PDF

---

### **🎨 ИНТЕРФЕЙС АДМИНКИ:**

#### **Главная страница "👥 Пользователи и прогресс":**
```
┌─────────────────────────────────────────────────────────┐
│ 📊 ОБЩАЯ СТАТИСТИКА                                     │
├─────────────────────────────────────────────────────────┤
│ 👥 Активных пользователей: 45  │ 📋 Заполнено анкет: 23 │
│ ⏱️ Среднее время: 18 мин      │ 📈 Конверсия: 51%      │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ 🔍 ПОИСК И ФИЛЬТРЫ                                      │
├─────────────────────────────────────────────────────────┤
│ [Поиск по имени...] [Статус: Все] [Дата: Последние 7д] │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ �� СПИСОК ПОЛЬЗОВАТЕЛЕЙ                                  │
├─────────────────────────────────────────────────────────┤
│ Имя          │ Статус    │ Прогресс │ Последняя активность│
│ Николай С.   │ Активен   │ 75%      │ 2 часа назад        │
│ Тест П.      │ Завершен  │ 100%     │ 1 день назад        │
└─────────────────────────────────────────────────────────┘
```

#### **Детальная страница пользователя:**
```
┌─────────────────────────────────────────────────────────┐
│ �� НИКОЛАЙ СТЕПАНОВ (ID: 123456789)                    │
├─────────────────────────────────────────────────────────┤
│ 📊 СТАТИСТИКА:                                          │
│ • Зарегистрирован: 15.07.2025                          │
│ • Всего сессий: 3                                       │
│ • Завершенных анкет: 1                                  │
│ • Среднее время: 22 минуты                              │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ 📋 АКТИВНАЯ СЕССИЯ (ID: 456)                            │
├─────────────────────────────────────────────────────────┤
│ Прогресс: ████████████████████░░░░ 80% (16/20 вопросов) │
│ Начата: 02.08.2025 10:30                                │
│ Последняя активность: 02.08.2025 11:15                 │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ 📝 ОТВЕТЫ НА ВОПРОСЫ                                    │
├─────────────────────────────────────────────────────────┤
│ 1. Название проекта: Мобильная библиотека для ОВЗ      │
│ 2. Описание: Создадим выездную библиотеку...            │
│ 3. Регион: Кемеровская область, Новокузнецкий район    │
│ ...                                                     │
└─────────────────────────────────────────────────────────┘
```

---

### **📅 ПЛАН РЕАЛИЗАЦИИ:**

#### **День 1:**
- ✅ Этап 1: Расширение базы данных
- ✅ Этап 2: Новые функции в database.py

#### **День 2:**
- ✅ Этап 3: Новый раздел в админке
- ✅ Этап 4: Детальный просмотр данных

#### **День 3:**
- ✅ Этап 5: Фильтры и поиск
- ✅ Этап 6: Экспорт и отчеты
- ✅ Тестирование и отладка

---

### **🎯 РЕЗУЛЬТАТ:**

После реализации получим:
- ✅ **Полный контроль** над пользователями и их прогрессом
- ✅ **Детальную аналитику** заполнения анкет
- ✅ **Удобные фильтры** и поиск
- ✅ **Экспорт данных** для анализа
- ✅ **Мониторинг** активных сессий

**Готовы начинать реализацию? С какого этапа начнем?** 🚀