#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª–æ—Å–æ—Ñ–∏–∏ –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä–∞ –≤ Qdrant –±–∞–∑—É –∑–Ω–∞–Ω–∏–π
"""
import requests
import uuid

QDRANT_HOST = "5.35.88.251"
QDRANT_PORT = 6333
COLLECTION_NAME = "knowledge_sections"

print("=" * 80)
print("–î–û–ë–ê–í–õ–ï–ù–ò–ï –§–ò–õ–û–°–û–§–ò–ò –ò–ù–¢–ï–†–í–¨–Æ–ï–†–ê –í QDRANT")
print("=" * 80)

# Load model
try:
    from sentence_transformers import SentenceTransformer
    print("\n[1/3] –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏...")
    model = SentenceTransformer("sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2")
    print("      ‚úÖ –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞")
except Exception as e:
    print(f"\n‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏: {e}")
    exit(1)

# Philosophy content - –∫–ª—é—á–µ–≤—ã–µ —Ä–∞–∑–¥–µ–ª—ã –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤
philosophy_sections = [
    {
        "section_name": "–§–∏–ª–æ—Å–æ—Ñ–∏—è –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä–∞: –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è",
        "content": """–ò–Ω—Ç–µ—Ä–≤—å—é–µ—Ä - —ç—Ç–æ –º–æ—Å—Ç –º–µ–∂–¥—É —Ö–∞–æ—Å–æ–º –∏–¥–µ–∏ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ —Ñ–æ–Ω–¥–∞.

–ß–µ–ª–æ–≤–µ–∫ –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å –∏–¥–µ–µ–π –≤ –≥–æ–ª–æ–≤–µ - —Ö–∞–æ—Ç–∏—á–Ω–æ–π, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π, –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π.
–§–æ–Ω–¥ –ø—Ä–µ–∑–∏–¥–µ–Ω—Ç—Å–∫–∏—Ö –≥—Ä–∞–Ω—Ç–æ–≤ (–§–ü–ì) - —ç—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –º–∞—à–∏–Ω–∞, —Ç—Ä–µ–±—É—é—â–∞—è —Ç–æ—á–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ —Ç–æ—á–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã.

–ó–∞–¥–∞—á–∞ –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä–∞: –ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å —Å—ã—Ä—É—é –∏–¥–µ—é –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∑–∞—è–≤–∫—É, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –§–ü–ì,
–ø—Ä–∏—á–µ–º —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –ø–æ —Ö–æ–¥—É —Ä–∞–∑–≥–æ–≤–æ—Ä–∞, –∞ –Ω–µ –ø–æ—Å–ª–µ.

–ö–ª—é—á–µ–≤–∞—è —Ü–µ–ª—å: –ß–µ–ª–æ–≤–µ–∫ –¥–æ–ª–∂–µ–Ω —É–π—Ç–∏ —Å –∞–Ω–∫–µ—Ç–æ–π, –∫–æ—Ç–æ—Ä–∞—è –≥–æ—Ç–æ–≤–∞ –∫ –ø–æ–¥–∞—á–µ –≤ –§–ü–ì, –±–µ–∑ –ø–µ—Ä–µ–¥–µ–ª–æ–∫."""
    },
    {
        "section_name": "–§–∏–ª–æ—Å–æ—Ñ–∏—è –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä–∞: 5 –∫–ª—é—á–µ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π",
        "content": """1. –í—ã—Ç—è–≥–∏–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–∑ —Ö–∞–æ—Å–∞ - –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç "—Ö–æ—á—É –¥–µ—Ç—è–º –ø–æ–º–æ—á—å" –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ü–∏—Ñ—Ä—ã:
—Å–∫–æ–ª—å–∫–æ –¥–µ—Ç–µ–π, –∫–∞–∫–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞, –∏–∑ –∫–∞–∫–∏—Ö —Å–µ–º–µ–π, –≤ –∫–∞–∫–æ–º —Ä–µ–≥–∏–æ–Ω–µ.

2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á–µ—Å—Ç–Ω–æ—Å—Ç—å –±—é–¥–∂–µ—Ç–∞ - –∫–æ–ø–∞–µ—Ç –¥–µ—Ç–∞–ª–∏: –Ω–∞ —á—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ, –ø–æ—á–µ–º—É —Ç–∞–∫–∞—è —Ü–µ–Ω–∞, –≥–¥–µ —Å–º–µ—Ç–∞ –ø–æ —Å—Ç–∞—Ç—å—è–º.

3. –ò—â–µ—Ç —Å–ª–∞–±—ã–µ –º–µ—Å—Ç–∞ –ü–û –•–û–î–£, –∞ –Ω–µ –ø–æ—Å–ª–µ - –ø–æ—Å–ª–µ –∫–∞–∂–¥—ã—Ö 5 –≤–æ–ø—Ä–æ—Å–æ–≤ –≥–æ–≤–æ—Ä–∏—Ç "–≤–æ—Ç —Ç—É—Ç —Å–ª–∞–±–æ, –¥–∞–≤–∞–π—Ç–µ —Å—Ä–∞–∑—É —É—Ç–æ—á–Ω–∏–º".

4. –ó–∞—Å—Ç–∞–≤–ª—è–µ—Ç –¥—É–º–∞—Ç—å –æ –ü–û–°–õ–ï –≥—Ä–∞–Ω—Ç–∞ - –∫–∞–∫ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –≥—Ä–∞–Ω—Ç–∞, –∫—Ç–æ –±—É–¥–µ—Ç –ø–ª–∞—Ç–∏—Ç—å, –µ—Å—Ç—å –ª–∏ –ø–∞—Ä—Ç–Ω–µ—Ä—ã.

5. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∞–∑—É –∑–Ω–∞–Ω–∏–π –§–ü–ì - –ª–µ–∑–µ—Ç –≤ Qdrant, —Å–º–æ—Ç—Ä–∏—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –∑–∞–¥–∞–µ—Ç –≤–æ–ø—Ä–æ—Å —Å —É—á–µ—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞—è–≤–æ–∫."""
    },
    {
        "section_name": "–§–∏–ª–æ—Å–æ—Ñ–∏—è –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä–∞: –ù–ï –¥–æ–ø—Ä–æ—Å—á–∏–∫, –∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç",
        "content": """–ò–Ω—Ç–µ—Ä–≤—å—é–µ—Ä –ù–ï –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ–ø—Ä–æ—Å—á–∏–∫–æ–º —Å —á–µ–∫-–ª–∏—Å—Ç–æ–º:
- –ù–µ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å "–≤–æ–ø—Ä–æ—Å-–æ—Ç–≤–µ—Ç"
- –ù–µ —ç–∫–∑–∞–º–µ–Ω –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ò–Ω—Ç–µ—Ä–≤—å—é–µ—Ä –î–û–õ–ñ–ï–ù –±—ã—Ç—å —É–º–Ω—ã–º –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–æ–º:
- –°–ª—ã—à–∏—Ç –∏–¥–µ—é —Ü–µ–ª–∏–∫–æ–º
- –ó–∞–¥–∞–µ—Ç —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã —Ç–∞–º, –≥–¥–µ –Ω—É–∂–Ω–æ
- –û–±—ä—è—Å–Ω—è–µ—Ç –ß–¢–û —Ö–æ—á–µ—Ç –§–ü–ì –∏ –ü–û–ß–ï–ú–£
- –ü–æ–º–æ–≥–∞–µ—Ç —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –ø–æ–ø–∞—Å—Ç—å –≤ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –ß–µ–ª–æ–≤–µ–∫ —á—É–≤—Å—Ç–≤—É–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É, –∞ –Ω–µ –¥–∞–≤–ª–µ–Ω–∏–µ

–û—â—É—â–µ–Ω–∏–µ –æ—Ç –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: –Ω–µ —ç–∫–∑–∞–º–µ–Ω, –∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è."""
    },
    {
        "section_name": "–§–∏–ª–æ—Å–æ—Ñ–∏—è –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä–∞: –ê–Ω–∞–ª–∏–∑ = –ê—É–¥–∏—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ",
        "content": """–ö–ª—é—á–µ–≤–æ–π –ø—Ä–∏–Ω—Ü–∏–ø (Adaptive –ø–æ–¥—Ö–æ–¥):

–ê–ù–ê–õ–ò–ó –û–¢–í–ï–¢–ê = –≠–¢–û –ò –ï–°–¢–¨ –ê–£–î–ò–¢

–ù–µ –Ω—É–∂–Ω–æ:
- –û—Ç–¥–µ–ª—å–Ω—ã–π AuditorAgent
- –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –∞—É–¥–∏—Ç—ã –ø–æ—Å–ª–µ –±–ª–æ–∫–æ–≤
- –≠—Ç–∞–ø "–ø–µ—Ä–µ–¥–µ–ª–∫–∏" –∞–Ω–∫–µ—Ç—ã

–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ:
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–∞–∂–¥—ã–π –æ—Ç–≤–µ—Ç —Å—Ä–∞–∑—É
- –†–µ—à–∞–µ–º: –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–ª–∏ –∫–æ–ø–∞—Ç—å –≥–ª—É–±–∂–µ
- –ï—Å–ª–∏ –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–∞ ‚â•7/10 - –∏–¥–µ–º –¥–∞–ª—å—à–µ
- –ï—Å–ª–∏ <7/10 - —É—Ç–æ—á–Ω—è–µ–º –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å
- –ê–Ω–∫–µ—Ç–∞ –≥–æ—Ç–æ–≤–∞ —Å—Ä–∞–∑—É (–∫–∞—á–µ—Å—Ç–≤–æ ‚â•80/100)

–≠—Ç–æ —ç–∫–æ–Ω–æ–º–∏—Ç LLM –≤—ã–∑–æ–≤—ã, —É–ª—É—á—à–∞–µ—Ç UX, –ø–æ–≤—ã—à–∞–µ—Ç –∑–∞–≤–µ—Ä—à–∞–µ–º–æ—Å—Ç—å —Å 70% –¥–æ 85%."""
    },
    {
        "section_name": "–§–∏–ª–æ—Å–æ—Ñ–∏—è –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä–∞: –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –ø–æ —Ç–µ–º–∞–º",
        "content": """12 —Ç–µ–º –≤–º–µ—Å—Ç–æ 15 —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤:
problem, goal, target_audience, methodology, budget, team, partners,
risks, results, sustainability, timeline, uniqueness

–ü–æ –∫–∞–∂–¥–æ–π —Ç–µ–º–µ:
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ: 7/10 (–¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ç–µ–º) –∏–ª–∏ 6/10 (–¥–ª—è –≤–∞–∂–Ω—ã—Ö)
- –ú–∞–∫—Å–∏–º—É–º –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ —Ç–µ–º–µ: 5
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—Ä–∞–∑—É –¥–∞–ª —Ö–æ—Ä–æ—à–∏–π –æ—Ç–≤–µ—Ç ‚Üí –∏–¥–µ–º –¥–∞–ª—å—à–µ (1 –≤–æ–ø—Ä–æ—Å)
- –ï—Å–ª–∏ —Å–ª–∞–±–æ ‚Üí –∫–æ–ø–∞–µ–º –≥–ª—É–±–∂–µ (–¥–æ 5 –≤–æ–ø—Ä–æ—Å–æ–≤)
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤: –æ—Ç 15 –¥–æ 30 (–∞–¥–∞–ø—Ç–∏–≤–Ω–æ)

–ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ Qdrant –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–µ–º—ã:
- –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–º–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–±—é–¥–∂–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞")
- –ë–µ—Ä–µ—à—å Top 3 —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–∞ –∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –§–ü–ì
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—à—å –≤–æ–ø—Ä–æ—Å —Å —É—á–µ—Ç–æ–º —ç—Ç–∏—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π"""
    }
]

print(f"\n[2/3] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –¥–ª—è {len(philosophy_sections)} —Ä–∞–∑–¥–µ–ª–æ–≤...")

# Add sections to Qdrant
points = []
for idx, section in enumerate(philosophy_sections):
    # Generate embedding
    content = section['content']
    embedding = model.encode(content, convert_to_tensor=False)

    # Create point
    point = {
        "id": str(uuid.uuid4()),
        "vector": embedding.tolist(),
        "payload": {
            "section_name": section['section_name'],
            "content": content,
            "source": "INTERVIEWER_PHILOSOPHY.md",
            "type": "philosophy",
            "priority": "P0"  # –ö—Ä–∏—Ç–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤
        }
    }
    points.append(point)
    print(f"   ‚úÖ {idx+1}/{len(philosophy_sections)}: {section['section_name'][:50]}...")

print(f"\n[3/3] –ó–∞–≥—Ä—É–∑–∫–∞ –≤ Qdrant ({QDRANT_HOST}:{QDRANT_PORT})...")

# Upload to Qdrant
response = requests.put(
    f"http://{QDRANT_HOST}:{QDRANT_PORT}/collections/{COLLECTION_NAME}/points",
    json={
        "points": points
    }
)

if response.status_code == 200:
    print(f"\n‚úÖ –£—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ {len(points)} —Ä–∞–∑–¥–µ–ª–æ–≤ —Ñ–∏–ª–æ—Å–æ—Ñ–∏–∏!")

    # Get updated stats
    response = requests.get(f"http://{QDRANT_HOST}:{QDRANT_PORT}/collections/{COLLECTION_NAME}")
    if response.status_code == 200:
        data = response.json()
        result = data.get('result', {})
        print(f"\nüìä –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"   ‚Ä¢ –í—Å–µ–≥–æ —Ä–∞–∑–¥–µ–ª–æ–≤: {result.get('points_count', 0)}")
        print(f"   ‚Ä¢ –ò–∑ –Ω–∏—Ö —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è: {len(points)}")
        print(f"   ‚Ä¢ –°—Ç–∞—Ç—É—Å: {result.get('status', 'unknown')}")
else:
    print(f"\n‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: {response.status_code}")
    print(response.text)

print("\n" + "=" * 80)
print("–§–ò–õ–û–°–û–§–ò–Ø –î–û–ë–ê–í–õ–ï–ù–ê –í –ë–ê–ó–£ –ó–ù–ê–ù–ò–ô")
print("–¢–µ–ø–µ—Ä—å –∞–≥–µ–Ω—Ç—ã-–∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã!")
print("=" * 80)
