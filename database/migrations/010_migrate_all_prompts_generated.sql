-- ============================================================================
-- Migration 010: АВТОМАТИЧЕСКИ СГЕНЕРИРОВАННАЯ миграция всех промптов
-- Дата генерации: 2025-10-10
-- Скрипт: scripts/generate_prompts_migration.py
-- ============================================================================

-- ============================================================================
-- Researcher V2: 27 экспертных запросов
-- ============================================================================

-- Блок 1: Проблема и социальная значимость (10 запросов)

INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block1'),
  'Block1 Query 1',
  'Запрос 1 блока 1',
  'Чётко сформулируй проблему ''{ПРОБЛЕМА}'' в контексте сферы ''{СФЕРА}''
            и целевой группы ''{ЦЕЛЕВАЯ_ГРУППА}''. Опиши суть проблемы, её масштаб и последствия
            для целевой аудитории. Источники: официальные документы, исследования.',
  'researcher_v2',
  'block1_query',
  1,
  '{"ПРОБЛЕМА": "string", "СФЕРА": "string", "ЦЕЛЕВАЯ_ГРУППА": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block1'),
  'Block1 Query 2',
  'Запрос 2 блока 1',
  'Найди официальные подтверждения проблемы ''{ПРОБЛЕМА}'' из следующих источников:
            - Росстат (rosstat.gov.ru) и ЕМИСС (fedstat.ru)
            - {ПРОФИЛЬНОЕ_МИНИСТЕРСТВО} (официальный сайт .gov.ru)
            - Исследования российских ВУЗов и НИИ по сфере ''{СФЕРА}''
            - Профильные реестры и базы данных

            Требования к результату:
            - Прямые цитаты с указанием источника, документа, даты публикации
            - Конкретные цифры с единицами измерения и периодами
            - URL ссылки на первоисточники
            - Уровень данных (РФ/субъект/муниципалитет)',
  'researcher_v2',
  'block1_query',
  2,
  '{"ПРОБЛЕМА": "string", "СФЕРА": "string", "ПРОФИЛЬНОЕ_МИНИСТЕРСТВО": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block1'),
  'Block1 Query 3',
  'Запрос 3 блока 1',
  'Проверь соответствие проблемы ''{ПРОБЛЕМА}'' национальным проектам и федеральным
            госпрограммам 2024-2030 по сфере ''{СФЕРА}''.

            Найди:
            1. Релевантные нацпроекты на сайте nationalprojects.ru
            2. Цели и показатели, связанные с проблемой
            3. Конкретные пункты паспортов проектов (номера пунктов, разделы)
            4. KPI нацпроектов, к которым может внести вклад проект

            Процитируй конкретные формулировки из паспортов нацпроектов.',
  'researcher_v2',
  'block1_query',
  3,
  '{"ПРОБЛЕМА": "string", "СФЕРА": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block1'),
  'Block1 Query 4',
  'Запрос 4 блока 1',
  'Найди региональные и муниципальные программы в регионе ''{РЕГИОН}'' за последние 3 года (2022-2025),
            связанные с проблемой ''{ПРОБЛЕМА}'' и сутью проекта.

            Источники:
            - Официальный портал правительства региона ''{РЕГИОН}''
            - Региональные министерства и ведомства по сфере ''{СФЕРА}''
            - Муниципальные программы (если указан ''{МУНИЦИПАЛИТЕТ}'')

            Для каждой программы укажи:
            - Название и паспорт программы
            - Целевые показатели (KPI)
            - Как проект может внести вклад в достижение KPI
            - Прямые цитаты из паспортов программ с номерами пунктов',
  'researcher_v2',
  'block1_query',
  4,
  '{"ПРОБЛЕМА": "string", "РЕГИОН": "string", "МУНИЦИПАЛИТЕТ": "string", "СФЕРА": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block1'),
  'Block1 Query 5',
  'Запрос 5 блока 1',
  'Проанализируй ландшафт существующих решений в РФ по проблеме ''{ПРОБЛЕМА}'' в сфере ''{СФЕРА}''.

            Найди:
            1. Основные акторы (НКО, государственные учреждения, социальные предприятия)
            2. Применяемые подходы и методики
            3. Масштабы охвата и результаты
            4. Позиции органов власти (цитаты из документов, выступлений)
            5. Количественные метрики эффективности решений

            Источники: базы НКО, реестры социальных проектов, отчёты министерств, профильные порталы.',
  'researcher_v2',
  'block1_query',
  5,
  '{"ПРОБЛЕМА": "string", "СФЕРА": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block1'),
  'Block1 Query 6',
  'Запрос 6 блока 1',
  'Перечисли меры государственной поддержки по сфере ''{СФЕРА}'' для решения проблемы ''{ПРОБЛЕМА}''.

            Найди:
            1. Гранты и субсидии (федеральные, региональные)
            2. Нормативные основания (законы, постановления, приказы)
            3. Условия участия и критерии отбора
            4. Доступность мер в регионе ''{РЕГИОН}''
            5. Статистика выделенных средств за период {ПЕРИОД}

            Источники: сайты фондов, порталы госуслуг, региональные порталы поддержки НКО.',
  'researcher_v2',
  'block1_query',
  6,
  '{"ПРОБЛЕМА": "string", "РЕГИОН": "string", "СФЕРА": "string", "ПЕРИОД": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block1'),
  'Block1 Query 7',
  'Запрос 7 блока 1',
  'Найди официальную статистику по проблеме ''{ПРОБЛЕМА}'' в регионе ''{РЕГИОН}''
            за период {ПЕРИОД} (минимум 3 года).

            Требования:
            1. Динамика показателей: абсолютные значения и темпы роста/снижения
            2. Сравнение с показателями РФ в целом
            3. Сравнение с регионом-лидером по данному показателю
            4. Указать уровень данных (РФ/субъект/муниципалитет)
            5. Источники: Росстат (rosstat.gov.ru), ЕМИСС (fedstat.ru), региональная статистика

            Оформить в виде таблицы с годами, показателями и источниками.',
  'researcher_v2',
  'block1_query',
  7,
  '{"ПРОБЛЕМА": "string", "РЕГИОН": "string", "ПЕРИОД": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block1'),
  'Block1 Query 8',
  'Запрос 8 блока 1',
  'Собери 3 успешных кейса/практики из РФ по сфере ''{СФЕРА}'', релевантные проблеме ''{ПРОБЛЕМА}''.

            Для каждого кейса укажи:
            1. Название проекта/программы и организация-реализатор
            2. Регион и период реализации
            3. Целевая аудитория и охват
            4. Достигнутые результаты (количественные и качественные)
            5. Источник информации (URL, дата публикации)
            6. Прямая цитата с ключевым результатом

            Источники: базы лучших практик министерств, доклады, профильные конкурсы и рейтинги.',
  'researcher_v2',
  'block1_query',
  8,
  '{"ПРОБЛЕМА": "string", "СФЕРА": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block1'),
  'Block1 Query 9',
  'Запрос 9 блока 1',
  'Собери 3 примера реального ущерба от нерешённой проблемы ''{ПРОБЛЕМА}'' в регионе ''{РЕГИОН}''.

            Виды ущерба (выбрать применимые к сфере ''{СФЕРА}''):
            - Социальный (снижение качества жизни, изоляция, неравенство)
            - Экономический (потери бюджета, снижение производительности)
            - Демографический (миграция, старение, убыль населения)
            - Здоровье (заболеваемость, инвалидность)
            - Образовательный (неуспеваемость, отсев)
            - Экологический (загрязнение, деградация среды)

            Для каждого примера:
            - Конкретный показатель ущерба (цифра, единица измерения, период)
            - Последствия для целевой группы ''{ЦЕЛЕВАЯ_ГРУППА}''
            - Источник (официальный документ, исследование)
            - Прямая цитата',
  'researcher_v2',
  'block1_query',
  9,
  '{"ПРОБЛЕМА": "string", "РЕГИОН": "string", "СФЕРА": "string", "ЦЕЛЕВАЯ_ГРУППА": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block1'),
  'Block1 Query 10',
  'Запрос 10 блока 1',
  'Зафиксируй прямые цифровые последствия, релевантные сфере ''{СФЕРА}'' и проблеме ''{ПРОБЛЕМА}''.

            Показатели для анализа (выбрать применимые):
            - Здоровье: заболеваемость, инвалидность, ожидаемая продолжительность жизни
            - Образование: успеваемость, доля завершивших обучение, доступность образования
            - Экология: уровень загрязнения, площадь нарушенных земель, выбросы
            - Безопасность: уровень преступности, травматизм, ЧП
            - Экономика: доходы населения, занятость, уровень бедности
            - Демография: рождаемость, миграция, возрастная структура

            Требования:
            - Конкретные цифры за период {ПЕРИОД} для региона ''{РЕГИОН}''
            - Прямые цитаты из официальных источников
            - Даты публикации данных
            - Связь показателей с проблемой ''{ПРОБЛЕМА}''',
  'researcher_v2',
  'block1_query',
  10,
  '{"ПРОБЛЕМА": "string", "РЕГИОН": "string", "СФЕРА": "string", "ПЕРИОД": "string"}'::jsonb,
  true
);


-- Блок 2: География и целевая аудитория (10 запросов)

INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block2'),
  'Block2 Query 1',
  'Запрос 1 блока 2',
  'Обоснуй выбор территории ''{РЕГИОН}/{МУНИЦИПАЛИТЕТ}'' для реализации проекта
            по решению проблемы ''{ПРОБЛЕМА}''.

            Найди официальные показатели:
            1. Масштаб и острота проблемы в регионе (статистика Росстат, ЕМИСС)
            2. Доступность профильных услуг по сфере ''{СФЕРА}''
            3. Демографическая структура (численность целевой группы ''{ЦЕЛЕВАЯ_ГРУППА}'')
            4. Социально-экономический контекст региона
            5. Сравнение с РФ и регионом-лидером за период {ПЕРИОД}

            Приведи прямые цитаты из первоисточников с метаданными.',
  'researcher_v2',
  'block2_query',
  1,
  '{"ПРОБЛЕМА": "string", "РЕГИОН": "string", "МУНИЦИПАЛИТЕТ": "string", "СФЕРА": "string", "ЦЕЛЕВАЯ_ГРУППА": "string", "ПЕРИОД": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block2'),
  'Block2 Query 2',
  'Запрос 2 блока 2',
  'Найди национальные, региональные и муниципальные стратегии/программы, релевантные теме проекта
            ''{ТЕМА_ПРОЕКТА}'' и сфере ''{СФЕРА}''.

            Для каждой стратегии/программы:
            1. Название и реквизиты документа
            2. Цели и целевые показатели (KPI)
            3. Как проект вносит вклад в достижение KPI (конкретная связка)
            4. Процитируй релевантные пункты документов

            Источники:
            - Стратегия социально-экономического развития региона ''{РЕГИОН}''
            - Региональные отраслевые программы по сфере ''{СФЕРА}''
            - Муниципальные программы (если есть ''{МУНИЦИПАЛИТЕТ}'')
            - Национальные проекты и госпрограммы',
  'researcher_v2',
  'block2_query',
  2,
  '{"РЕГИОН": "string", "МУНИЦИПАЛИТЕТ": "string", "СФЕРА": "string", "ТЕМА_ПРОЕКТА": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block2'),
  'Block2 Query 3',
  'Запрос 3 блока 2',
  'Оцени инфраструктуру и ресурсы территории ''{РЕГИОН}/{МУНИЦИПАЛИТЕТ}'' по сфере ''{СФЕРА}''.

            Найди данные:
            1. Количество профильных учреждений (школы, центры, больницы, клубы и т.п.)
            2. Кадровый потенциал (специалисты, работники сферы)
            3. Материально-техническая база (площадки, оборудование)
            4. Транспортная доступность услуг
            5. "Пустыни услуг" - территории с недоступностью сервисов

            Источники:
            - Официальные реестры учреждений (министерства, ведомства)
            - Региональные справочники и базы данных
            - Карты инфраструктуры (geoportal, региональные ГИС)
            - Статистические отчёты органов власти

            Приведи конкретные цифры и ссылки.',
  'researcher_v2',
  'block2_query',
  3,
  '{"РЕГИОН": "string", "МУНИЦИПАЛИТЕТ": "string", "СФЕРА": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block2'),
  'Block2 Query 4',
  'Запрос 4 блока 2',
  'Зафиксируй спрос, предложение и разрыв в услугах по сфере ''{СФЕРА}''
            в регионе ''{РЕГИОН}'' применительно к проблеме ''{ПРОБЛЕМА}''.

            Анализ:
            1. Спрос: потребность целевой группы ''{ЦЕЛЕВАЯ_ГРУППА}'' (численность, доля)
            2. Предложение: доступные услуги, программы, места (количество, охват)
            3. Разрыв: дефицит услуг, очереди, недостаток мест
            4. Динамика разрыва за период {ПЕРИОД}

            Подтверждения:
            - Официальная статистика (Росстат, ЕМИСС, региональные данные)
            - Отчёты профильных ведомств
            - Результаты опросов населения (если доступны)

            Дай количественную оценку разрыва в процентах или абсолютных единицах.',
  'researcher_v2',
  'block2_query',
  4,
  '{"ПРОБЛЕМА": "string", "РЕГИОН": "string", "СФЕРА": "string", "ЦЕЛЕВАЯ_ГРУППА": "string", "ПЕРИОД": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block2'),
  'Block2 Query 5',
  'Запрос 5 блока 2',
  'Детально опиши целевую аудиторию проекта: ''{ЦЕЛЕВАЯ_ГРУППА}'' в регионе ''{РЕГИОН}''.

            Параметры:
            1. Возраст: {ВОЗРАСТ} (уточнить по официальным возрастным группам Росстат)
            2. Социальный статус и характеристики целевой группы
            3. География проживания (город/село, конкретные муниципалитеты)
            4. Численность целевой группы в регионе (общая)
            5. Численность/доля, затронутых проблемой ''{ПРОБЛЕМА}''
            6. Метод определения объёма целевой группы (формула, источник данных)

            Источники:
            - Демографическая статистика Росстат
            - Региональные базы данных
            - Специализированные исследования по сфере ''{СФЕРА}''

            Укажи уровень данных (РФ/субъект/муниципалитет) и даты актуальности.',
  'researcher_v2',
  'block2_query',
  5,
  '{"ПРОБЛЕМА": "string", "РЕГИОН": "string", "СФЕРА": "string", "ЦЕЛЕВАЯ_ГРУППА": "string", "ВОЗРАСТ": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block2'),
  'Block2 Query 6',
  'Запрос 6 блока 2',
  'Сформируй сравнительную таблицу "''{РЕГИОН}'' vs РФ vs регион-лидер"
            по ключевым показателям ''{ИНДИКАТОР}'' для сферы ''{СФЕРА}''.

            Показатели для сравнения:
            1. Охват целевой группы ''{ЦЕЛЕВАЯ_ГРУППА}'' услугами (%)
            2. Обеспеченность инфраструктурой (учреждения на 10 тыс. населения)
            3. Кадровая обеспеченность (специалисты на 10 тыс. населения)
            4. Финансирование сферы (руб. на душу населения)
            5. Ключевой индикатор проблемы ''{ПРОБЛЕМА}''

            Период: {ПЕРИОД} (минимум 3 года для отслеживания динамики)

            Источники: Росстат, ЕМИСС, федеральные и региональные статистические отчёты

            Укажи уровень данных для каждого показателя.',
  'researcher_v2',
  'block2_query',
  6,
  '{"ПРОБЛЕМА": "string", "РЕГИОН": "string", "СФЕРА": "string", "ЦЕЛЕВАЯ_ГРУППА": "string", "ПЕРИОД": "string", "ИНДИКАТОР": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block2'),
  'Block2 Query 7',
  'Запрос 7 блока 2',
  'Дай аргументы масштабируемости подхода ''{ПОДХОД_МОДЕЛЬ}'' на другие территории и группы.

            Найди:
            1. Российские аналоги с доказанной переносимостью модели
            2. Международные практики (если применимо к российским условиям)
            3. Нормативные и методические основания для репликации
            4. Условия успешной репликации (необходимые ресурсы, инфраструктура)
            5. Примеры успешного масштабирования в сфере ''{СФЕРА}''

            Источники:
            - Базы лучших практик (АСИ, профильные министерства)
            - Методические рекомендации по сфере
            - Аналитические доклады о социальных инновациях
            - Программы поддержки масштабирования

            Процитируй ключевые положения о масштабируемости.',
  'researcher_v2',
  'block2_query',
  7,
  '{"СФЕРА": "string", "ПОДХОД_МОДЕЛЬ": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block2'),
  'Block2 Query 8',
  'Запрос 8 блока 2',
  'Определи местных партнёров и стейкхолдеров для реализации проекта по теме ''{ТЕМА_ПРОЕКТА}''
            в регионе ''{РЕГИОН}''.

            Категории партнёров:
            1. Органы власти (администрация, профильные комитеты/департаменты)
            2. Профильные учреждения по сфере ''{СФЕРА}''
            3. Образовательные организации (школы, ВУЗы, доп. образование)
            4. Социальная защита и здравоохранение
            5. НКО и общественные организации
            6. Бизнес и социальные предприятия

            Для каждой категории:
            - Роль в проекте
            - Формы взаимодействия
            - Нормативные основания для партнёрства (если есть)
            - Примеры успешного партнёрства в регионе (если найдены)

            Не перечисляй конкретные организации, укажи типы и категории.',
  'researcher_v2',
  'block2_query',
  8,
  '{"РЕГИОН": "string", "СФЕРА": "string", "ТЕМА_ПРОЕКТА": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block2'),
  'Block2 Query 9',
  'Запрос 9 блока 2',
  'Проанализируй территориальные риски и ограничения для реализации проекта
            в регионе ''{РЕГИОН}/{МУНИЦИПАЛИТЕТ}'' по сфере ''{СФЕРА}''.

            Риски:
            1. Правовые ограничения (региональное законодательство, требования)
            2. Логистические сложности (транспорт, доступность территорий)
            3. Сезонность и климатические факторы
            4. Кадровые риски (дефицит специалистов, текучесть)
            5. Инфраструктурные ограничения (отсутствие площадок, оборудования)
            6. Социокультурные особенности региона

            Для каждого риска:
            - Описание и оценка вероятности
            - Меры минимизации
            - Ссылки на официальные документы (если применимо)

            Источники: региональные аналитические доклады, стратегии развития, отчёты ведомств.',
  'researcher_v2',
  'block2_query',
  9,
  '{"РЕГИОН": "string", "МУНИЦИПАЛИТЕТ": "string", "СФЕРА": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block2'),
  'Block2 Query 10',
  'Запрос 10 блока 2',
  'Зафиксируй "точки роста" - обоснуй, почему проект особенно актуален именно
            в регионе ''{РЕГИОН}/{МУНИЦИПАЛИТЕТ}'' и как создаёт эффект витрины для масштабирования.

            Аргументы:
            1. Кластер проблем: концентрация нескольких связанных проблем в регионе
            2. Недоохват целевой аудитории: большой процент ''{ЦЕЛЕВАЯ_ГРУППА}'' без доступа к услугам
            3. Приоритет в программах: регион выделен как приоритетный в госпрограммах
            4. Готовность инфраструктуры: наличие базовых условий для быстрого старта
            5. Региональная поддержка: заинтересованность властей и партнёров
            6. Эффект демонстрации: как успешная реализация здесь мотивирует другие регионы

            Подтверждения:
            - Данные о масштабе проблемы в регионе vs РФ
            - Цитаты из региональных стратегий и программ
            - Примеры приоритетизации региона в федеральных инициативах

            Покажи потенциал региона как пилотной площадки.',
  'researcher_v2',
  'block2_query',
  10,
  '{"РЕГИОН": "string", "МУНИЦИПАЛИТЕТ": "string", "ЦЕЛЕВАЯ_ГРУППА": "string"}'::jsonb,
  true
);


-- Блок 3: Задачи, мероприятия и цели (7 запросов)

INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block3'),
  'Block3 Query 1',
  'Запрос 1 блока 3',
  'Сформулируй 3-5 ключевых задач проекта на основе проблемы ''{ПРОБЛЕМА}''
            в сфере ''{СФЕРА}'' для целевой группы ''{ЦЕЛЕВАЯ_ГРУППА}''.

            Требования к задачам:
            1. Каждая задача явно адресует аспект проблемы (указать какой именно)
            2. Задачи измеримы и реалистичны для периода {ПЕРИОД}
            3. Задачи взаимодополняющие, не дублируют друг друга
            4. Формулировка через глагол совершенного вида (создать, обеспечить, повысить)

            Для каждой задачи укажи:
            - Формулировка задачи
            - Какой барьер/аспект проблемы снимает
            - Связь с целевой группой

            Опирайся на лучшие практики проектного управления в сфере ''{СФЕРА}''.',
  'researcher_v2',
  'block3_query',
  1,
  '{"ПРОБЛЕМА": "string", "СФЕРА": "string", "ЦЕЛЕВАЯ_ГРУППА": "string", "ПЕРИОД": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block3'),
  'Block3 Query 2',
  'Запрос 2 блока 3',
  'Для каждой задачи из предыдущего запроса предложи 1-2 конкретных мероприятия
            и объясни механизм влияния на проблему ''{ПРОБЛЕМА}''.

            Для каждого мероприятия:
            1. Название и краткое описание (1-2 предложения)
            2. К какой задаче относится
            3. Механизм влияния: какой барьер снимает / какую потребность закрывает у ''{ЦЕЛЕВАЯ_ГРУППА}''
            4. Формат реализации (групповой/индивидуальный, очный/онлайн и т.п.)
            5. Примерная длительность и частота

            Опирайся на:
            - Методические рекомендации по сфере ''{СФЕРА}''
            - Успешные практики из других проектов (если есть примеры)
            - Стандарты и регламенты профильных ведомств',
  'researcher_v2',
  'block3_query',
  2,
  '{"ПРОБЛЕМА": "string", "СФЕРА": "string", "ЦЕЛЕВАЯ_ГРУППА": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block3'),
  'Block3 Query 3',
  'Запрос 3 блока 3',
  'Свяжи мероприятия с измеримыми KPI (ключевыми показателями эффективности).

            Для каждого мероприятия определи:
            1. Количественные показатели:
               - Объём (количество мероприятий, участников, часов)
               - Охват (доля целевой группы ''{ЦЕЛЕВАЯ_ГРУППА}'')
               - Удержание (доля продолжающих участие)

            2. Качественные показатели:
               - Изменения у участников (знания, навыки, поведение)
               - Удовлетворённость (по шкале или опросам)

            3. Для каждого KPI укажи:
               - Название показателя
               - Единица измерения
               - Целевое значение
               - Период измерения
               - Метод фиксации (как будем считать)

            Ориентируйся на стандартные показатели сферы ''{СФЕРА}'' из федеральных программ.',
  'researcher_v2',
  'block3_query',
  3,
  '{"СФЕРА": "string", "ЦЕЛЕВАЯ_ГРУППА": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block3'),
  'Block3 Query 4',
  'Запрос 4 блока 3',
  'Укажи базовые предпосылки и категории партнёров для реализации проекта
            по теме ''{ТЕМА_ПРОЕКТА}'' в регионе ''{РЕГИОН}''.

            Предпосылки:
            1. Нормативные основания (законы, приказы, регламенты)
            2. Инфраструктурные условия (наличие площадок, оборудования)
            3. Кадровые ресурсы (категории специалистов)
            4. Информационная база (реестры, базы данных ЦА)
            5. Финансовые условия (источники софинансирования, если нужны)

            Партнёры (категории, без конкретных названий):
            - Органы власти (какие уровни и направления)
            - Профильные учреждения по сфере ''{СФЕРА}''
            - Другие категории стейкхолдеров

            Для каждой категории: роль в проекте, формы взаимодействия.',
  'researcher_v2',
  'block3_query',
  4,
  '{"РЕГИОН": "string", "СФЕРА": "string", "ТЕМА_ПРОЕКТА": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block3'),
  'Block3 Query 5',
  'Запрос 5 блока 3',
  'Проанализируй, насколько главная цель ''{ГЛАВНАЯ_ЦЕЛЬ}'' соответствует
            решению проблемы ''{ПРОБЛЕМА}''.

            Критерии анализа:
            1. Релевантность: адресует ли цель суть проблемы?
            2. Достижимость: реально ли достичь цель за период {ПЕРИОД}?
            3. Измеримость: можно ли объективно зафиксировать достижение цели?
            4. Конкретность: есть ли чёткие критерии (количественные/качественные)?
            5. Временные рамки: указан ли срок достижения?

            Оцени по шкале 1-10 соответствие цели каждому критерию SMART.
            Укажи, что нужно доработать для повышения качества формулировки цели.',
  'researcher_v2',
  'block3_query',
  5,
  '{"ПРОБЛЕМА": "string", "ГЛАВНАЯ_ЦЕЛЬ": "string", "ПЕРИОД": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block3'),
  'Block3 Query 6',
  'Запрос 6 блока 3',
  'Опиши логическую связку "задачи → мероприятия → KPI → вклад в главную цель"
            для проекта по решению проблемы ''{ПРОБЛЕМА}''.

            Логика Input → Output → Outcome:

            1. Input (Входящие ресурсы):
               - Команда, партнёры, инфраструктура, финансирование

            2. Activities (Мероприятия):
               - Конкретные активности по каждой задаче

            3. Output (Непосредственные результаты):
               - Количество проведённых мероприятий
               - Охват участников из ''{ЦЕЛЕВАЯ_ГРУППА}''

            4. Outcome (Изменения):
               - Изменения у целевой группы (знания, поведение, доступ)
               - Вклад в решение проблемы ''{ПРОБЛЕМА}''

            5. Impact (Долгосрочный эффект):
               - Достижение главной цели ''{ГЛАВНАЯ_ЦЕЛЬ}''
               - Снижение остроты проблемы в регионе ''{РЕГИОН}''

            Покажи, как каждая задача через свои KPI ведёт к достижению главной цели.',
  'researcher_v2',
  'block3_query',
  6,
  '{"ПРОБЛЕМА": "string", "РЕГИОН": "string", "ЦЕЛЕВАЯ_ГРУППА": "string", "ГЛАВНАЯ_ЦЕЛЬ": "string"}'::jsonb,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, order_index, variables, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'researcher_block3'),
  'Block3 Query 7',
  'Запрос 7 блока 3',
  'Предложи 2-3 альтернативных формулировки главной цели проекта по решению проблемы ''{ПРОБЛЕМА}''
            для целевой группы ''{ЦЕЛЕВАЯ_ГРУППА}'' в регионе ''{РЕГИОН}''.

            Требования к формулировкам:
            1. Формат SMART:
               - Specific (конкретная): что именно меняется
               - Measurable (измеримая): количественный/качественный критерий
               - Achievable (достижимая): реалистична за период {ПЕРИОД}
               - Relevant (релевантная): адресует проблему напрямую
               - Time-bound (ограниченная во времени): чёткий срок

            2. Для каждого варианта цели укажи:
               - Формулировка (1 предложение)
               - Проверка SMART (галочки по каждому критерию)
               - Ключевой показатель для измерения достижения
               - Базовое и целевое значение показателя

            Опирайся на:
            - Формулировки целей в успешных проектах сферы ''{СФЕРА}''
            - Целевые показатели нацпроектов и госпрограмм
            - Лучшие практики целеполагания в социальной сфере',
  'researcher_v2',
  'block3_query',
  7,
  '{"ПРОБЛЕМА": "string", "РЕГИОН": "string", "СФЕРА": "string", "ЦЕЛЕВАЯ_ГРУППА": "string", "ПЕРИОД": "string"}'::jsonb,
  true
);


-- ============================================================================
-- Writer V2: Goal, Backstory, Stage 1, Stage 2
-- ============================================================================


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, is_active, priority) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'agent_system'),
  'Writer V2 Goal',
  'Цель агента Writer V2',
  'Создать качественную заявку на грант с использованием результатов исследования (27 запросов), минимум 10 цитат и 2 таблицы',
  'writer_v2',
  'goal',
  true,
  100
),
(
  (SELECT id FROM prompt_categories WHERE name = 'agent_system'),
  'Writer V2 Backstory',
  'Предыстория агента Writer V2',
  'Ты профессиональный грант-райтер с 15-летним опытом написания заявок. Ты знаешь все секреты успешных заявок, умеешь структурировать информацию и убедительно представлять проекты. Твои заявки содержат официальную статистику, цитаты из госпрограмм, успешные кейсы и сравнительные таблицы. Твои заявки имеют высокий процент одобрения (40-50%).',
  'writer_v2',
  'backstory',
  true,
  100
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, max_tokens, temperature, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'writer_stage1'),
  'Writer V2 Stage 1: Planning',
  'Промпт для планирования структуры заявки (Stage 1)',
  'Ты эксперт по написанию заявок на Президентские гранты РФ. Твоя задача - спланировать структуру заявки согласно официальной форме ФПГ.

КОНТЕКСТ ПРОЕКТА:
Название: {project_name}
Описание: {description}
Проблема: {problem}
Решение: {solution}
Бюджет: {budget} рублей
Срок реализации: {timeline} месяцев

РЕЗУЛЬТАТЫ ИССЛЕДОВАНИЯ (27 запросов):
Блок 1 - Проблема: {block1_summary}
Блок 2 - География: {block2_summary}
Блок 3 - Цели и задачи: {block3_summary}

Статистика:
- Всего источников: {sources_count}
- Ключевые факты: {key_facts_count}

СТРУКТУРА ЗАЯВКИ НА ПРЕЗИДЕНТСКИЙ ГРАНТ:
Создай детальный план из 9 разделов:
1. КРАТКОЕ ОПИСАНИЕ (0.5-1 стр, ~2000 символов)
2. ОПИСАНИЕ ПРОБЛЕМЫ (2-4 стр, ~8000 символов)
3. ЦЕЛЬ ПРОЕКТА (1 абзац, ~500 символов, SMART)
4. РЕЗУЛЬТАТЫ
5. ЗАДАЧИ (3-5 задач)
6. ПАРТНЕРЫ
7. ИНФОРМАЦИОННОЕ СОПРОВОЖДЕНИЕ
8. ДАЛЬНЕЙШЕЕ РАЗВИТИЕ
9. КАЛЕНДАРНЫЙ ПЛАН

Ответ дай в формате JSON с детальным планом каждого раздела.',
  'writer_v2',
  'stage1_planning',
  2000,
  0.3,
  true
);


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, max_tokens, temperature, is_active) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'writer_stage2'),
  'Writer V2 Stage 2: Writing',
  'Промпт для написания текста заявки (Stage 2)',
  'Ты профессиональный грант-райтер с 15-летним опытом написания заявок на Президентские гранты РФ.

КРИТИЧНО ВАЖНО - СТИЛЬ НАПИСАНИЯ:
✅ Официальный, деловой, бюрократический стиль
✅ Третье лицо ВСЕГДА ("проект направлен на...", "планируется...")
✅ НЕТ первого лица ("мы", "наш")
✅ Безэмоциональный тон (только факты, цифры, ссылки)

ФОРМАТ ЦИТИРОВАНИЯ:
"По данным [организация] [факт]. (ссылка: https://...)"

ДАННЫЕ ПРОЕКТА:
{user_answers}

ПЛАН СТРУКТУРЫ (из Stage 1):
{plan}

ЦИТАТЫ (минимум 10):
{citations}

ТАБЛИЦЫ (минимум 2):
{tables}

БЛОК 1 - ПРОБЛЕМА:
{research_block1}

БЛОК 2 - ГЕОГРАФИЯ:
{research_block2}

БЛОК 3 - ЦЕЛИ:
{research_block3}

ЗАДАНИЕ:
Напиши полную заявку на грант (25,000+ символов), включающую ВСЕ 9 разделов.

ТРЕБОВАНИЯ:
✅ Общий объем: 25,000+ символов
✅ Раздел 2 "Проблема": 8,000+ символов
✅ Официальный стиль, третье лицо
✅ Минимум 10 цитат
✅ 2 таблицы
✅ Календарный план в таблице

Верни результат в формате JSON с 9 секциями.',
  'writer_v2',
  'stage2_writing',
  8000,
  0.3,
  true
);


-- ============================================================================
-- Reviewer: Goal, Backstory
-- ============================================================================


INSERT INTO agent_prompts (category_id, name, description, prompt_template, agent_type, prompt_type, is_active, priority) VALUES
(
  (SELECT id FROM prompt_categories WHERE name = 'agent_system'),
  'Reviewer Goal',
  'Цель агента Reviewer',
  'Провести финальную оценку готовности гранта к подаче и рассчитать вероятность одобрения (40-50%)',
  'reviewer',
  'goal',
  true,
  100
),
(
  (SELECT id FROM prompt_categories WHERE name = 'agent_system'),
  'Reviewer Backstory',
  'Предыстория агента Reviewer',
  'Ты эксперт-ревьюер грантовых заявок с 25-летним опытом работы в экспертных комиссиях. Ты оцениваешь готовность заявок к подаче на основе 4 критериев: доказательная база (40%), структура (30%), индикаторный матчинг (20%), экономика (10%). Твоя оценка точно предсказывает вероятность одобрения заявки.',
  'reviewer',
  'backstory',
  true,
  100
);


