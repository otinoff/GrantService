# –°—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–µ–ø–ª–æ—è GrantService

## üéØ –§–∏–ª–æ—Å–æ—Ñ–∏—è –¥–µ–ø–ª–æ—è

**–ü—Ä–∏–Ω—Ü–∏–ø**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö + –ú–∏–Ω–∏–º—É–º —Ä—É—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π

## üìã –¢–µ–∫—É—â–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è (v2.0)

### 1. –ó–∞—â–∏—Ç–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ü–µ—Ä–µ–¥ –ª—é–±—ã–º–∏ git –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏:

```bash
# 1. –ë—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
cp data/grantservice.db data/grantservice.db.backup

# 2. –ë—ç–∫–∞–ø —Ç–æ–∫–µ–Ω–æ–≤ –∏ —Å–µ–∫—Ä–µ—Ç–æ–≤
cp config/.env /tmp/grantservice_env_safe

# 3. –ó–∞—â–∏—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –¥–∞–Ω–Ω—ã–º–∏
mv data /tmp/grantservice_data_safe
```

### 2. –£–º–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞

**–°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è (–æ–ø–∞—Å–Ω–∞—è)**:
```bash
git reset --hard origin/master  # –í—Å–µ–≥–¥–∞ hard reset
```
- ‚ùå –£–¥–∞–ª—è–µ—Ç untracked —Ñ–∞–π–ª—ã
- ‚ùå –¢–µ—Ä—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- ‚ö†Ô∏è –û–ø–∞—Å–Ω–æ –¥–ª—è `.env`, –ª–æ–≥–æ–≤, –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

**–ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è (–±–µ–∑–æ–ø–∞—Å–Ω–∞—è)**:
```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–æ–∂–Ω–æ –ª–∏ —Å–¥–µ–ª–∞—Ç—å fast-forward
if git merge-base --is-ancestor HEAD origin/master; then
  # –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π pull (–Ω–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤)
  git pull origin master
else
  # –ï—Å—Ç—å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ–º –∏ –¥–µ–ª–∞–µ–º reset
  echo "‚ö†Ô∏è Diverged from origin, forcing reset..."
  git reset --hard origin/master
fi
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- ‚úÖ –í 90% —Å–ª—É—á–∞–µ–≤ –æ–±—ã—á–Ω—ã–π `pull` (–±—ã—Å—Ç—Ä–µ–µ, –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ)
- ‚úÖ `reset --hard` —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö
- ‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ –ª–æ–≥–∞—Ö –∫–æ–≥–¥–∞ –¥–µ–ª–∞–µ–º reset
- ‚úÖ Untracked —Ñ–∞–π–ª—ã –æ—Å—Ç–∞—é—Ç—Å—è –Ω–µ—Ç—Ä–æ–Ω—É—Ç—ã–º–∏

### 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
mv /tmp/grantservice_data_safe data

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤
cp /tmp/grantservice_env_safe config/.env
chmod 600 config/.env
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î
if [ -f "data/grantservice.db" ]; then
  echo "‚úì Database OK"
else
  echo "‚úó Database MISSING - restoring from backup!"
  cp data/grantservice.db.backup data/grantservice.db
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
if grep -q "YOUR_BOT_TOKEN" config/.env 2>/dev/null; then
  echo "‚úó Token is placeholder - check config!"
  exit 1
fi
```

## ü§î –ü–æ—á–µ–º—É —Ä–∞–Ω—å—à–µ –±—ã–ª `git reset --hard`?

### –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏—á–∏–Ω—ã:

1. **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ —Ä–µ—à–∞–µ—Ç –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã
2. **–ì–∞—Ä–∞–Ω—Ç–∏—è** - —Å–µ—Ä–≤–µ—Ä –≤—Å–µ–≥–¥–∞ –≤ —Ç–æ—á–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –∏–∑ Git
3. **–ó–∞—â–∏—Ç–∞ –æ—Ç —Ä—É—á–Ω—ã—Ö –ø—Ä–∞–≤–æ–∫** - –Ω–∏–∫—Ç–æ –Ω–µ –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### –ü–æ—á–µ–º—É —ç—Ç–æ –ø–ª–æ—Ö–æ:

| –ü—Ä–æ–±–ª–µ–º–∞ | –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è | –ß–∞—Å—Ç–æ—Ç–∞ |
|----------|-------------|---------|
| –£–¥–∞–ª–µ–Ω–∏–µ `.env` | –ë–æ—Ç –ø–∞–¥–∞–µ—Ç, –Ω—É–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ç–æ–∫–µ–Ω | 2025-10-01 |
| –ü–æ—Ç–µ—Ä—è –ª–æ–≥–æ–≤ | –°–ª–æ–∂–Ω–æ –¥–µ–±–∞–∂–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã | –†–µ–¥–∫–æ |
| –£–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ | –¢–µ—Ä—è–µ—Ç—Å—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | –ò–Ω–æ–≥–¥–∞ |
| –ù–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π | –ù–µ –≤–∏–¥–Ω–æ —á—Ç–æ –±—ã–ª–æ –ø–æ—Ç–µ—Ä—è–Ω–æ | –í—Å–µ–≥–¥–∞ |

## ‚úÖ –ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥: Defense in Depth

### –£—Ä–æ–≤–µ–Ω—å 1: –£–º–Ω—ã–π git pull
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ fast-forward
- Reset —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π

### –£—Ä–æ–≤–µ–Ω—å 2: –ó–∞—â–∏—Ç–∞ –ø–µ—Ä–µ–¥ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- –ë—ç–∫–∞–ø –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –º–µ—Å—Ç–æ
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Ñ–∞–π–ª—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç

### –£—Ä–æ–≤–µ–Ω—å 3: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ
- –í–æ–∑–≤—Ä–∞—Ç –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –º–µ—Å—Ç–æ
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏

### –£—Ä–æ–≤–µ–Ω—å 4: –í–∞–ª–∏–¥–∞—Ü–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –ë–î –Ω–∞ –º–µ—Å—Ç–µ
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Ç–æ–∫–µ–Ω—ã –≤–∞–ª–∏–¥–Ω—ã–µ
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—Å—Ç–∏–ª–∏—Å—å

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

### Hard Reset (—Å—Ç–∞—Ä—ã–π)
```bash
git reset --hard origin/master
# –í—Ä–µ–º—è: ~1 —Å–µ–∫
# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: ‚ö†Ô∏è –ù–∏–∑–∫–∞—è
# –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å: ‚úÖ –í—ã—Å–æ–∫–∞—è
# –†–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö: ‚ö†Ô∏è –í—ã—Å–æ–∫–∏–π
```

### Smart Pull (–Ω–æ–≤—ã–π)
```bash
if can_fast_forward; then
  git pull
else
  git reset --hard
fi
# –í—Ä–µ–º—è: ~1-2 —Å–µ–∫
# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: ‚úÖ –í—ã—Å–æ–∫–∞—è
# –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å: ‚úÖ –í—ã—Å–æ–∫–∞—è
# –†–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö: ‚úÖ –ù–∏–∑–∫–∏–π
```

### Smart Pull + –ó–∞—â–∏—Ç–∞ (current)
```bash
backup_critical_files()
smart_git_update()
restore_critical_files()
validate_everything()
# –í—Ä–µ–º—è: ~5-10 —Å–µ–∫
# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: ‚úÖ –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è
# –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å: ‚úÖ –í—ã—Å–æ–∫–∞—è
# –†–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö: ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π
```

## üîß –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –≤ –Ω–æ–≤—É—é –ø–∞–ø–∫—É
git clone repo /var/GrantService-new
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
cp -r /var/GrantService/data /var/GrantService-new/
cp /var/GrantService/config/.env /var/GrantService-new/config/
# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Å–∏–º–ª–∏–Ω–∫
ln -sfn /var/GrantService-new /var/GrantService-current
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
systemctl restart grantservice-*
```

**–ü–ª—é—Å—ã**: –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è, –æ—Ç–∫–∞—Ç –∑–∞ —Å–µ–∫—É–Ω–¥—ã
**–ú–∏–Ω—É—Å—ã**: –ë–æ–ª—å—à–µ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ, —Å–ª–æ–∂–Ω–µ–µ

### –í–∞—Ä–∏–∞–Ω—Ç 2: Docker (–±—É–¥—É—â–µ–µ)
```bash
docker pull grantservice:latest
docker-compose up -d
```

**–ü–ª—é—Å—ã**: –ò–∑–æ–ª—è—Ü–∏—è, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å
**–ú–∏–Ω—É—Å—ã**: –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Docker, volumes –¥–ª—è –¥–∞–Ω–Ω—ã—Ö

### –í–∞—Ä–∏–∞–Ω—Ç 3: Blue-Green Deployment
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é –Ω–∞ –ø–æ—Ä—Ç—É 8502
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å nginx –Ω–∞ –Ω–æ–≤—ã–π –ø–æ—Ä—Ç
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é
```

**–ü–ª—é—Å—ã**: Zero downtime
**–ú–∏–Ω—É—Å—ã**: –°–ª–æ–∂–Ω–æ—Å—Ç—å, –Ω—É–∂–Ω–æ –¥–≤–∞ –Ω–∞–±–æ—Ä–∞ –ø–æ—Ä—Ç–æ–≤

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–µ–ø–ª–æ—è

| –ú–µ—Ç—Ä–∏–∫ | –¶–µ–ª—å | –¢–µ–∫—É—â–µ–µ |
|--------|------|---------|
| Downtime –±–æ—Ç–∞ | < 10 —Å–µ–∫ | ~5 —Å–µ–∫ ‚úÖ |
| Downtime –∞–¥–º–∏–Ω–∫–∏ | < 10 —Å–µ–∫ | ~5 —Å–µ–∫ ‚úÖ |
| –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö | 0% | 0% ‚úÖ |
| –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –¥–µ–ø–ª–æ—è | > 99% | 100% ‚úÖ |
| –í—Ä–µ–º—è –¥–µ–ø–ª–æ—è | < 2 –º–∏–Ω | ~1 –º–∏–Ω ‚úÖ |
| –û—Ç–∫–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ | < 30 —Å–µ–∫ | Manual ‚ö†Ô∏è |

## üéØ Roadmap —É–ª—É—á—à–µ–Ω–∏–π

### Q4 2025
- [x] –ó–∞—â–∏—Ç–∞ config/.env –æ—Ç –ø–æ—Ç–µ—Ä–∏
- [x] –£–º–Ω—ã–π git pull –≤–º–µ—Å—Ç–æ hard reset
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- [ ] Health checks –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### Q1 2026
- [ ] Docker-based deployment
- [ ] Blue-Green deployment –¥–ª—è zero downtime
- [ ] Automated smoke tests –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫ –¥–µ–ø–ª–æ—è

### Q2 2026
- [ ] Staging –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- [ ] Canary deployments
- [ ] A/B testing infrastructure
- [ ] Full CI/CD pipeline —Å —Ç–µ—Å—Ç–∞–º–∏

## üìö –°—Å—ã–ª–∫–∏

- [Git reset vs pull](https://stackoverflow.com/questions/1125968/)
- [Zero downtime deployment](https://cloud.google.com/architecture/implementing-deployment-and-testing-strategies)
- [GitHub Actions best practices](https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions)

---

**–í–µ—Ä—Å–∏—è**: 2.0
**–î–∞—Ç–∞**: 2025-10-01
**–ê–≤—Ç–æ—Ä**: Claude Code
**–°—Ç–∞—Ç—É—Å**: –ê–∫—Ç–∏–≤–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
