# âš¡ Quick Test Guide - ProductionWriter

**Date:** 2025-10-24
**Bot:** @grant_service_bot
**Status:** âœ… READY FOR TESTING

---

## ðŸŽ¯ Quick Start (3 minutes)

### Step 1: ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð±Ð¾Ñ‚Ð°

```
Telegram â†’ @grant_service_bot â†’ /start
```

### Step 2: ÐŸÑ€Ð¾Ð¹Ñ‚Ð¸ Ð¸Ð½Ñ‚ÐµÑ€Ð²ÑŒÑŽ (ÐµÑÐ»Ð¸ Ð½ÐµÑ‚ Ð°Ð½ÐºÐµÑ‚Ñ‹)

```
ÐÐ°Ð¶Ð°Ñ‚ÑŒ ÐºÐ½Ð¾Ð¿ÐºÑƒ "ðŸ†• Ð˜Ð½Ñ‚ÐµÑ€Ð²ÑŒÑŽ V2"
ÐžÑ‚Ð²ÐµÑ‚Ð¸Ñ‚ÑŒ Ð½Ð° Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹ (~5 Ð¼Ð¸Ð½ÑƒÑ‚)
```

### Step 3: Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð³Ñ€Ð°Ð½Ñ‚

```
/generate_grant
```

**ÐžÐ¶Ð¸Ð´Ð°ÐµÐ¼Ñ‹Ð¹ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:**
```
ðŸš€ ÐÐ°Ñ‡Ð¸Ð½Ð°ÑŽ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸ÑŽ Ð³Ñ€Ð°Ð½Ñ‚Ð¾Ð²Ð¾Ð¹ Ð·Ð°ÑÐ²ÐºÐ¸...

ðŸ“‹ ÐÐ½ÐºÐµÑ‚Ð°: AN-20251024-001
â± Ð­Ñ‚Ð¾ Ð·Ð°Ð¹Ð¼ÐµÑ‚ ~2-3 Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹

Ð¯ Ð¿Ñ€Ð¸ÑˆÐ»ÑŽ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð³Ð´Ð° Ð·Ð°ÑÐ²ÐºÐ° Ð±ÑƒÐ´ÐµÑ‚ Ð³Ð¾Ñ‚Ð¾Ð²Ð°!
```

### Step 4: ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð³Ñ€Ð°Ð½Ñ‚

**Ð§ÐµÑ€ÐµÐ· 2-3 Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹:**
```
âœ… Ð“Ñ€Ð°Ð½Ñ‚Ð¾Ð²Ð°Ñ Ð·Ð°ÑÐ²ÐºÐ° Ð³Ð¾Ñ‚Ð¾Ð²Ð°!

ðŸ“‹ ÐÐ½ÐºÐµÑ‚Ð°: AN-20251024-001
ðŸ†” Grant ID: GA-20251024-XXXXXXXX

ðŸ“Š Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°:
â€¢ Ð¡Ð¸Ð¼Ð²Ð¾Ð»Ð¾Ð²: 44,000
â€¢ Ð¡Ð»Ð¾Ð²: 6,500
â€¢ Ð¡ÐµÐºÑ†Ð¸Ð¹: 10
â€¢ Ð’Ñ€ÐµÐ¼Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸: 130.2s

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ /get_grant Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð·Ð°ÑÐ²ÐºÐ¸.
```

**ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð³Ñ€Ð°Ð½Ñ‚:**
```
/get_grant
```

**Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:** ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚Ðµ Ñ‚ÐµÐºÑÑ‚ Ð³Ñ€Ð°Ð½Ñ‚Ð¾Ð²Ð¾Ð¹ Ð·Ð°ÑÐ²ÐºÐ¸ (Ñ€Ð°Ð·Ð±Ð¸Ñ‚Ñ‹Ð¹ Ð½Ð° Ñ‡Ð°ÑÑ‚Ð¸ ÐµÑÐ»Ð¸ >4000 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²)

---

## ðŸ“‹ All Commands

### 1. `/generate_grant` - Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð³Ñ€Ð°Ð½Ñ‚

**Ð‘ÐµÐ· Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð² (Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÑŽÑŽ Ð°Ð½ÐºÐµÑ‚Ñƒ):**
```
/generate_grant
```

**Ð¡ ÑƒÐºÐ°Ð·Ð°Ð½Ð¸ÐµÐ¼ Ð°Ð½ÐºÐµÑ‚Ñ‹:**
```
/generate_grant AN-20251024-001
```

**ÐšÐ¾Ð³Ð´Ð° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ:**
- ÐŸÐ¾ÑÐ»Ðµ Ð¿Ñ€Ð¾Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ Ð¸Ð½Ñ‚ÐµÑ€Ð²ÑŒÑŽ
- ÐšÐ¾Ð³Ð´Ð° Ð½ÑƒÐ¶Ð½Ð° Ð½Ð¾Ð²Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð³Ñ€Ð°Ð½Ñ‚Ð°
- ÐŸÐ¾ÑÐ»Ðµ Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð°Ð½ÐºÐµÑ‚Ñ‹

### 2. `/get_grant` - ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð³Ñ€Ð°Ð½Ñ‚

**Ð‘ÐµÐ· Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð² (Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ Ð³Ñ€Ð°Ð½Ñ‚):**
```
/get_grant
```

**Ð¡ ÑƒÐºÐ°Ð·Ð°Ð½Ð¸ÐµÐ¼ Ð°Ð½ÐºÐµÑ‚Ñ‹:**
```
/get_grant AN-20251024-001
```

**ÐšÐ¾Ð³Ð´Ð° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ:**
- ÐŸÐ¾ÑÐ»Ðµ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸
- Ð”Ð»Ñ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð°
- Ð”Ð»Ñ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ñ‚ÐµÐºÑÑ‚Ð°

### 3. `/list_grants` - Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð³Ñ€Ð°Ð½Ñ‚Ð¾Ð²

```
/list_grants
```

**ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚:**
- Ð’ÑÐµ Ð²Ð°ÑˆÐ¸ Ð³Ñ€Ð°Ð½Ñ‚Ð¾Ð²Ñ‹Ðµ Ð·Ð°ÑÐ²ÐºÐ¸
- Grant ID
- Anketa ID
- ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²
- Ð”Ð°Ñ‚Ð° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ
- Ð¡Ñ‚Ð°Ñ‚ÑƒÑ

---

## ðŸ§ª Test Scenarios

### Scenario 1: Happy Path âœ…

```
1. /start
2. ÐšÐ½Ð¾Ð¿ÐºÐ° "ðŸ†• Ð˜Ð½Ñ‚ÐµÑ€Ð²ÑŒÑŽ V2"
3. ÐŸÑ€Ð¾Ð¹Ñ‚Ð¸ Ð¸Ð½Ñ‚ÐµÑ€Ð²ÑŒÑŽ Ð´Ð¾ ÐºÐ¾Ð½Ñ†Ð°
4. /generate_grant
5. Ð”Ð¾Ð¶Ð´Ð°Ñ‚ÑŒÑÑ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ (2-3 Ð¼Ð¸Ð½)
6. /get_grant
```

**Expected:** ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð»Ð½Ñ‹Ð¹ Ð³Ñ€Ð°Ð½Ñ‚ ~44K ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²

### Scenario 2: Ð‘ÐµÐ· Ð°Ð½ÐºÐµÑ‚Ñ‹ âŒ

```
1. ÐÐ¾Ð²Ñ‹Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ
2. /generate_grant
```

**Expected:**
```
âŒ Ð£ Ð²Ð°Ñ Ð½ÐµÑ‚ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ‹Ñ… Ð°Ð½ÐºÐµÑ‚.
ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, ÑÐ½Ð°Ñ‡Ð°Ð»Ð° Ð¿Ñ€Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ Ð¸Ð½Ñ‚ÐµÑ€Ð²ÑŒÑŽ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð¾Ð¹ /start
```

### Scenario 3: ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð½Ð°Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ âš ï¸

```
1. /generate_grant AN-20251024-001
2. Ð”Ð¾Ð¶Ð´Ð°Ñ‚ÑŒÑÑ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ
3. /generate_grant AN-20251024-001 (ÐµÑ‰Ðµ Ñ€Ð°Ð·)
```

**Expected:**
```
âœ… Ð”Ð»Ñ Ð°Ð½ÐºÐµÑ‚Ñ‹ AN-20251024-001 ÑƒÐ¶Ðµ ÐµÑÑ‚ÑŒ Ð³Ð¾Ñ‚Ð¾Ð²Ð°Ñ Ð³Ñ€Ð°Ð½Ñ‚Ð¾Ð²Ð°Ñ Ð·Ð°ÑÐ²ÐºÐ°!

ðŸ“Š Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°:
â€¢ Ð¡Ð¸Ð¼Ð²Ð¾Ð»Ð¾Ð²: 44,000
â€¢ Ð¡Ð»Ð¾Ð²: 6,500
...

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ /get_grant AN-20251024-001 Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð·Ð°ÑÐ²ÐºÐ¸.
```

### Scenario 4: Ð§ÑƒÐ¶Ð°Ñ Ð°Ð½ÐºÐµÑ‚Ð° âŒ

```
1. /generate_grant AN-20251024-OTHER-USER
```

**Expected:**
```
âŒ ÐÐ½ÐºÐµÑ‚Ð° AN-20251024-OTHER-USER Ð½Ðµ Ð¿Ñ€Ð¸Ð½Ð°Ð´Ð»ÐµÐ¶Ð¸Ñ‚ Ð²Ð°Ð¼.
```

### Scenario 5: ÐŸÐ°Ñ€Ð°Ð»Ð»ÐµÐ»ÑŒÐ½Ð°Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ â³

```
1. /generate_grant
2. /generate_grant (ÑÑ€Ð°Ð·Ñƒ Ð¶Ðµ)
```

**Expected:**
```
â³ Ð£ Ð²Ð°Ñ ÑƒÐ¶Ðµ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½Ð° Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð³Ñ€Ð°Ð½Ñ‚Ð°.
ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð´Ð¾Ð¶Ð´Ð¸Ñ‚ÐµÑÑŒ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¹ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸.
```

---

## ðŸ“Š What to Check

### During Generation:

- âœ… Progress notification sent
- âœ… Bot remains responsive
- âœ… No errors in logs
- âœ… Generation completes within 2-3 minutes

### After Generation:

- âœ… Success notification received
- âœ… Statistics shown (chars, words, time)
- âœ… Admin notification sent (if configured)
- âœ… Grant saved to database

### When Getting Grant:

- âœ… Grant text received
- âœ… Automatic splitting if >4000 chars
- âœ… All sections present (10 sections)
- âœ… Status updated to 'sent_to_user'

---

## ðŸ› Known Issues

### None Yet! ðŸŽ‰

Ð•ÑÐ»Ð¸ Ð½Ð°Ð¹Ð´ÐµÑ‚Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹:
1. Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ error message
2. ÐžÑ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ñƒ
3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð»Ð¾Ð³Ð¸: `journalctl -u grantservice-bot -f`

---

## ðŸ“ž Support

### Logs:

```bash
# SSH to server
ssh root@5.35.88.251

# Check logs
sudo journalctl -u grantservice-bot -f | grep -i grant

# Check bot status
sudo systemctl status grantservice-bot
```

### Database:

```bash
# Connect
psql -h localhost -p 5434 -U grantservice -d grantservice

# Check grants
SELECT grant_id, anketa_id, user_id, status, character_count, created_at
FROM grants
ORDER BY created_at DESC
LIMIT 10;

# Check sessions
SELECT anketa_id, user_id, status, completed_at
FROM sessions
WHERE status = 'completed'
ORDER BY completed_at DESC
LIMIT 10;
```

---

## âœ… Test Checklist

### Basic:

- [ ] `/generate_grant` Ð±ÐµÐ· Ð°Ð½ÐºÐµÑ‚ â†’ error
- [ ] `/generate_grant` Ñ Ð°Ð½ÐºÐµÑ‚Ð¾Ð¹ â†’ success
- [ ] `/get_grant` â†’ grant received
- [ ] `/list_grants` â†’ list shown

### Advanced:

- [ ] Long grant (>4000 chars) â†’ auto split
- [ ] Parallel generation â†’ blocked
- [ ] Existing grant â†’ not regenerated
- [ ] Wrong anketa_id â†’ error
- [ ] Other user anketa â†’ error

### Performance:

- [ ] Generation time ~2-3 min
- [ ] Bot responsive during generation
- [ ] No memory leaks
- [ ] No errors in logs

### Integration:

- [ ] User LLM preference used
- [ ] Qdrant queries executed
- [ ] PostgreSQL connected
- [ ] Admin notifications sent
- [ ] Database updated correctly

---

**Status:** âœ… READY FOR TESTING
**Created:** 2025-10-24
**Next:** Start testing!
