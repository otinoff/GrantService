# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ E2E —Ç–µ—Å—Ç–∞ –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤
**–î–∞—Ç–∞**: 2025-10-06
**–¶–µ–ª—å**: –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç –†–ï–ê–õ–¨–ù–´–ï –∞–≥–µ–Ω—Ç—ã —Å –†–ï–ê–õ–¨–ù–´–ú–ò LLM

---

## üéØ –ß—Ç–æ —Ç–∞–∫–æ–µ –ù–ê–°–¢–û–Ø–©–ò–ô E2E —Ç–µ—Å—Ç

### –û—Ç–ª–∏—á–∏—è –æ—Ç —Ç–µ–∫—É—â–∏—Ö —Ç–µ—Å—Ç–æ–≤:

| –ê—Å–ø–µ–∫—Ç | –¢–µ–∫—É—â–∏–µ —Ç–µ—Å—Ç—ã (Fake) | –ù–∞—Å—Ç–æ—è—â–∏–π E2E |
|--------|---------------------|---------------|
| –î–∞–Ω–Ω—ã–µ | Hardcoded –≤ —Ç–µ—Å—Ç–µ | –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è LLM |
| –ê–≥–µ–Ω—Ç—ã | –ú–æ–∫–∏ (fake results) | –†–µ–∞–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã |
| LLM –≤—ã–∑–æ–≤—ã | –ù–ï–¢ | –î–ê (GigaChat/Claude) |
| –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è | <3 —Å–µ–∫ | 30-60 —Å–µ–∫ |
| –†–µ–∑—É–ª—å—Ç–∞—Ç | –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π | –í–∞—Ä—å–∏—Ä—É–µ—Ç—Å—è |
| –°—Ç–æ–∏–º–æ—Å—Ç—å | $0 | ~$0.50 –∑–∞ –∑–∞–ø—É—Å–∫ |

---

## üìä –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª E2E —Ç–µ—Å—Ç–∞

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (Hardcoded –æ—Ç–≤–µ—Ç—ã)
```python
# –†–µ–∞–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ 24 –≤–æ–ø—Ä–æ—Å–∞ –∞–Ω–∫–µ—Ç—ã
GRANT_ANSWERS = {
    "project_name": "–¢–µ—Ö–Ω–æ–¶–µ–Ω—Ç—Ä –ö–µ–º–µ—Ä–æ–≤–æ - –ò–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –º–æ–ª–æ–¥–µ–∂–∏",
    "project_goal": "–°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è IT-–∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π –º–æ–ª–æ–¥–µ–∂–∏ –ö—É–∑–±–∞—Å—Å–∞",
    "target_audience": "–®–∫–æ–ª—å–Ω–∏–∫–∏ –∏ —Å—Ç—É–¥–µ–Ω—Ç—ã 14-25 –ª–µ—Ç, –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º, —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–æ–π –∏ 3D-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏",
    "project_duration": "12 –º–µ—Å—è—Ü–µ–≤",
    "budget": "2500000",
    "expected_results": [
        "–û–±—É—á–µ–Ω–∏–µ 250+ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤",
        "–°–æ–∑–¥–∞–Ω–∏–µ 15+ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤",
        "–¢—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ 40% –≤—ã–ø—É—Å–∫–Ω–∏–∫–æ–≤",
        "–û—Ç–∫—Ä—ã—Ç–∏–µ 3 —Ñ–∏–ª–∏–∞–ª–æ–≤ –≤ –ö–µ–º–µ—Ä–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏"
    ],
    "innovation": "–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º VR/AR —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π",
    "social_impact": "–°–Ω–∏–∂–µ–Ω–∏–µ –º–æ–ª–æ–¥–µ–∂–Ω–æ–π –±–µ–∑—Ä–∞–±–æ—Ç–∏—Ü—ã –Ω–∞ 15%, —Ä–∞–∑–≤–∏—Ç–∏–µ IT-—ç–∫–æ—Å–∏—Å—Ç–µ–º—ã —Ä–µ–≥–∏–æ–Ω–∞",
    "sustainability": "–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ –∫—É—Ä—Å—ã, –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ, –∞—Ä–µ–Ω–¥–∞ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –¥–ª—è —Ö–∞–∫–∞—Ç–æ–Ω–æ–≤",
    "team_experience": "–ö–æ–º–∞–Ω–¥–∞ –∏–∑ 7 —á–µ–ª–æ–≤–µ–∫ —Å –æ–ø—ã—Ç–æ–º –≤ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ –∏ IT –æ—Ç 5 –¥–æ 20 –ª–µ—Ç",
    # ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ 16 –ø–æ–ª–µ–π
}
```

### –®–∞–≥ 2: –í—ã–∑–æ–≤ Interviewer Agent
```python
from agents.interviewer_agent import InterviewerAgent

# –°–æ–∑–¥–∞–µ–º –∞–≥–µ–Ω—Ç–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º DB
interviewer = InterviewerAgent(db)

# –°–æ–∑–¥–∞–µ–º —Å–µ—Å—Å–∏—é –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç–≤–µ—Ç—ã
session_id = interviewer.start_interview(telegram_id=999999999)

for question_id, answer in GRANT_ANSWERS.items():
    interviewer.save_answer(session_id, question_id, answer)

interviewer.complete_interview(session_id)
```

### –®–∞–≥ 3: –í—ã–∑–æ–≤ Auditor Agent (–†–ï–ê–õ–¨–ù–´–ô LLM)
```python
from agents.auditor_agent import AuditorAgent

auditor = AuditorAgent(db)

# ‚úÖ –í–ê–ñ–ù–û: –í—ã–∑—ã–≤–∞–µ—Ç –ù–ê–°–¢–û–Ø–©–ò–ô GigaChat/Claude
audit_result = auditor.analyze_project(session_id)

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# {
#   'approval_status': 'approved',
#   'average_score': 8.5,
#   'strengths': ['–ß–µ—Ç–∫–∞—è —Ü–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è', '–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –±—é–¥–∂–µ—Ç', ...],
#   'weaknesses': ['–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Ç—Ä–∏–∫ –æ—Ü–µ–Ω–∫–∏', ...],
#   'recommendations': ['–î–æ–±–∞–≤–∏—Ç—å KPI –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏', ...]
# }
```

### –®–∞–≥ 4: –í—ã–∑–æ–≤ Planner Agent (–†–ï–ê–õ–¨–ù–´–ô LLM)
```python
from agents.planner_agent import PlannerAgent

planner = PlannerAgent(db)

# ‚úÖ –í–ê–ñ–ù–û: –í—ã–∑—ã–≤–∞–µ—Ç –ù–ê–°–¢–û–Ø–©–ò–ô GigaChat/Claude
plan = planner.create_structure(session_id, audit_result)

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# {
#   'sections': [
#     {'name': '–ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å', 'word_count': 800, 'key_points': [...]},
#     {'name': '–¶–µ–ª–∏ –∏ –∑–∞–¥–∞—á–∏', 'word_count': 600, ...},
#     {'name': '–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è', 'word_count': 1200, ...},
#     # ... 8 —Å–µ–∫—Ü–∏–π
#   ],
#   'total_word_count': 6500
# }
```

### –®–∞–≥ 5: –í—ã–∑–æ–≤ Researcher Agent (Perplexity API)
```python
from agents.researcher_agent import ResearcherAgent

researcher = ResearcherAgent(db)

# ‚úÖ –í–ê–ñ–ù–û: –†–µ–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ Perplexity
research_data = researcher.find_similar_grants(session_id)

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# {
#   'similar_grants': [
#     {'title': 'IT-–ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –¢–æ–º—Å–∫', 'amount': 3000000, 'success': True},
#     {'title': '–¢–µ—Ö–Ω–æ–ø–∞—Ä–∫ –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫', 'amount': 5000000, ...},
#   ],
#   'grant_funds': [
#     {'name': '–§–æ–Ω–¥ –ø—Ä–µ–∑–∏–¥–µ–Ω—Ç—Å–∫–∏—Ö –≥—Ä–∞–Ω—Ç–æ–≤', 'max_amount': 10000000, 'requirements': [...]},
#   ],
#   'statistics': {'average_approval_rate': 0.35, ...}
# }
```

### –®–∞–≥ 6: –í—ã–∑–æ–≤ Writer Agent (–†–ï–ê–õ–¨–ù–´–ô LLM –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç)
```python
from agents.writer_agent import WriterAgent

writer = WriterAgent(db, llm_provider='gigachat')  # –∏–ª–∏ 'claude_code'

# ‚úÖ –í–ê–ñ–ù–û: –ù–ê–°–¢–û–Ø–©–ê–Ø –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ LLM
grant = writer.write_grant(
    session_id=session_id,
    structure=plan,
    research=research_data,
    target_fund='–§–æ–Ω–¥ –ø—Ä–µ–∑–∏–¥–µ–Ω—Ç—Å–∫–∏—Ö –≥—Ä–∞–Ω—Ç–æ–≤'
)

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# {
#   'grant_id': 'GRANT_12345',
#   'grant_title': '–¢–µ—Ö–Ω–æ–¶–µ–Ω—Ç—Ä –ö–µ–º–µ—Ä–æ–≤–æ - –ò–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –º–æ–ª–æ–¥–µ–∂–∏',
#   'grant_content': '# –ì–†–ê–ù–¢–û–í–ê–Ø –ó–ê–Ø–í–ö–ê\n\n## 1. –ê–ö–¢–£–ê–õ–¨–ù–û–°–¢–¨ –ü–†–û–ï–ö–¢–ê\n\n–í —É—Å–ª–æ–≤–∏—è—Ö... [6500+ —Å–ª–æ–≤]',
#   'quality_score': 9.2,
#   'word_count': 6834,
#   'tokens_used': 12450,
#   'cost': 0.45  # USD
# }
```

### –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
```python
# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –≥—Ä–∞–Ω—Ç —Å–æ–∑–¥–∞–Ω
assert grant['grant_id'] is not None
assert len(grant['grant_content']) > 5000, "–ì—Ä–∞–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–º (5000+ —Å–∏–º–≤–æ–ª–æ–≤)"
assert grant['quality_score'] >= 8.0, "–ö–∞—á–µ—Å—Ç–≤–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤—ã—Å–æ–∫–∏–º"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É
assert '## 1. –ê–ö–¢–£–ê–õ–¨–ù–û–°–¢–¨ –ü–†–û–ï–ö–¢–ê' in grant['grant_content']
assert '## 2. –¶–ï–õ–ò –ò –ó–ê–î–ê–ß–ò' in grant['grant_content']
assert '## 3. –ú–ï–¢–û–î–û–õ–û–ì–ò–Ø' in grant['grant_content']
assert '–§–æ–Ω–¥ –ø—Ä–µ–∑–∏–¥–µ–Ω—Ç—Å–∫–∏—Ö –≥—Ä–∞–Ω—Ç–æ–≤' in grant['grant_content']

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
saved_grant = db.execute_query(
    "SELECT * FROM grants WHERE grant_id = %s",
    (grant['grant_id'],)
)
assert len(saved_grant) == 1
assert saved_grant[0]['status'] == 'completed'
```

---

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –¥–ª—è E2E —Ç–µ—Å—Ç–∞

### 1. –ê–≥–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å LLM –∫–ª–∏–µ–Ω—Ç—ã
```python
# agents/writer_agent.py
class WriterAgent:
    def __init__(self, db, llm_client=None):
        self.db = db
        self.llm_client = llm_client or self._create_default_llm()

    def write_grant(self, session_id, structure, research):
        # –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç
        prompt = self._build_prompt(session_id, structure, research)

        # –í—ã–∑—ã–≤–∞–µ–º LLM
        response = self.llm_client.generate(
            prompt=prompt,
            max_tokens=8000,
            temperature=0.7
        )

        return response
```

### 2. –ü—Ä–æ–º–ø—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏
```python
# agents/prompts/writer_grant_template.txt
–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—é –≥—Ä–∞–Ω—Ç–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫ –¥–ª—è {fund_name}.

–ö–û–ù–¢–ï–ö–°–¢ –ü–†–û–ï–ö–¢–ê:
{project_context}

–°–¢–†–£–ö–¢–£–†–ê –ó–ê–Ø–í–ö–ò:
{structure}

–ò–°–°–õ–ï–î–û–í–ê–ù–ò–ï:
{research_data}

–ó–ê–î–ê–ù–ò–ï:
–ù–∞–ø–∏—à–∏ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é –≥—Ä–∞–Ω—Ç–æ–≤—É—é –∑–∞—è–≤–∫—É –Ω–∞ {word_count} —Å–ª–æ–≤, —Å–ª–µ–¥—É—è —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –≤—ã—à–µ.
–ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —è–∑—ã–∫, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ü–∏—Ñ—Ä—ã, —Å—Å—ã–ª–∞–π—Å—è –Ω–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ.

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
- –§–æ—Ä–º–∞—Ç: Markdown
- –û–±—ä–µ–º: {word_count}¬±10% —Å–ª–æ–≤
- –°—Ç–∏–ª—å: –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ-–¥–µ–ª–æ–≤–æ–π
- –§–æ–∫—É—Å: –°–æ—Ü–∏–∞–ª—å–Ω–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å, –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å, —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
```

### 3. –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–º–ø—Ç–∞–º–∏ –≤ –ë–î
```sql
-- –¢–∞–±–ª–∏—Ü–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤
CREATE TABLE agent_prompts (
    id SERIAL PRIMARY KEY,
    agent_name VARCHAR(50) NOT NULL,  -- 'writer', 'auditor', etc.
    prompt_type VARCHAR(50) NOT NULL,  -- 'grant_template', 'audit_template', etc.
    prompt_text TEXT NOT NULL,
    variables JSONB,  -- {'fund_name': 'string', 'word_count': 'int'}
    version INTEGER DEFAULT 1,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- –ò–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
CREATE INDEX idx_agent_prompts_active ON agent_prompts(agent_name, prompt_type, is_active);
```

---

## üé® UI –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ (web-admin)

### –°—Ç—Ä–∞–Ω–∏—Ü–∞ "ü§ñ –ê–≥–µ–Ω—Ç—ã" ‚Üí –í–∫–ª–∞–¥–∫–∞ –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞

#### –ü—Ä–∏–º–µ—Ä –¥–ª—è Writer Agent:

```python
# web-admin/pages/ü§ñ_–ê–≥–µ–Ω—Ç—ã.py

def render_writer_prompts():
    """–†–∞–∑–¥–µ–ª —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ Writer Agent"""

    st.markdown("### üìù –ü—Ä–æ–º–ø—Ç—ã Writer Agent")

    # –ü–æ–ª—É—á–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã
    prompts = execute_query("""
        SELECT id, prompt_type, prompt_text, variables, version
        FROM agent_prompts
        WHERE agent_name = 'writer' AND is_active = TRUE
        ORDER BY prompt_type
    """)

    for prompt in prompts:
        with st.expander(f"üìÑ {prompt['prompt_type']} (v{prompt['version']})"):
            # –ü–æ–∫–∞–∑–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
            if prompt['variables']:
                st.json(prompt['variables'])

            # –†–µ–¥–∞–∫—Ç–æ—Ä –ø—Ä–æ–º–ø—Ç–∞
            new_text = st.text_area(
                "–¢–µ–∫—Å—Ç –ø—Ä–æ–º–ø—Ç–∞:",
                value=prompt['prompt_text'],
                height=300,
                key=f"prompt_{prompt['id']}"
            )

            col1, col2, col3 = st.columns(3)

            with col1:
                if st.button("üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å", key=f"save_{prompt['id']}"):
                    execute_update("""
                        UPDATE agent_prompts
                        SET prompt_text = %s,
                            version = version + 1,
                            updated_at = NOW()
                        WHERE id = %s
                    """, (new_text, prompt['id']))
                    st.success("‚úÖ –ü—Ä–æ–º–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω!")
                    st.rerun()

            with col2:
                if st.button("üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å", key=f"test_{prompt['id']}"):
                    # –ü–æ–∫–∞–∑–∞—Ç—å preview —Å –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
                    st.code(new_text.format(
                        fund_name="–§–æ–Ω–¥ –ø—Ä–µ–∑–∏–¥–µ–Ω—Ç—Å–∫–∏—Ö –≥—Ä–∞–Ω—Ç–æ–≤",
                        word_count=6500,
                        # ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
                    ))

            with col3:
                if st.button("‚Ü©Ô∏è –û—Ç–∫–∞—Ç–∏—Ç—å", key=f"rollback_{prompt['id']}"):
                    # –û—Ç–∫–∞—Ç–∏—Ç—å –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
                    pass
```

---

## üì¶ –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è

### 1. –¢–µ—Å—Ç: `tests/integration/test_real_e2e_agents.py`
```python
@pytest.mark.integration
@pytest.mark.real_llm  # –¢—Ä–µ–±—É–µ—Ç API –∫–ª—é—á–∏
@pytest.mark.expensive  # –°—Ç–æ–∏—Ç –¥–µ–Ω–µ–≥
class TestRealE2EAgents:
    """–ù–∞—Å—Ç–æ—è—â–∏–π E2E —Ç–µ—Å—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏ LLM"""

    def test_full_grant_cycle_with_real_llm(self, db):
        """–ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä–∞–Ω—Ç–∞ —á–µ—Ä–µ–∑ —Ä–µ–∞–ª—å–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã"""
        # ... –∫–æ–¥ –≤—ã—à–µ
```

### 2. –ü—Ä–æ–º–ø—Ç—ã: `agents/prompts/`
```
agents/prompts/
‚îú‚îÄ‚îÄ writer/
‚îÇ   ‚îú‚îÄ‚îÄ grant_presidential_fund.txt
‚îÇ   ‚îú‚îÄ‚îÄ grant_youth_fund.txt
‚îÇ   ‚îî‚îÄ‚îÄ grant_international.txt
‚îú‚îÄ‚îÄ auditor/
‚îÇ   ‚îî‚îÄ‚îÄ project_audit_template.txt
‚îú‚îÄ‚îÄ planner/
‚îÇ   ‚îî‚îÄ‚îÄ structure_template.txt
‚îî‚îÄ‚îÄ README.md
```

### 3. UI: –û–±–Ω–æ–≤–∏—Ç—å `web-admin/pages/ü§ñ_–ê–≥–µ–Ω—Ç—ã.py`
- –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª "üìù –ü—Ä–æ–º–ø—Ç—ã" –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
- –†–µ–¥–∞–∫—Ç–æ—Ä —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤

---

## ‚úÖ Checklist —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### Phase 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (2-3 —á–∞—Å–∞)
- [ ] –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `agent_prompts` –≤ –ë–î
- [ ] –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∫–ª–∞—Å—Å—ã –∞–≥–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ–º–ø—Ç–∞–º–∏ –∏–∑ –ë–î

### Phase 2: E2E —Ç–µ—Å—Ç (3-4 —á–∞—Å–∞)
- [ ] –°–æ–∑–¥–∞—Ç—å `test_real_e2e_agents.py`
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å hardcoded –æ—Ç–≤–µ—Ç—ã (24 –≤–æ–ø—Ä–æ—Å–∞)
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—ã–∑–æ–≤ –≤—Å–µ—Ö 5 –∞–≥–µ–Ω—Ç–æ–≤ –ø–æ —Ü–µ–ø–æ—á–∫–µ
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç (–ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è API –∫–ª—é—á GigaChat)

### Phase 3: UI –¥–ª—è –ø—Ä–æ–º–ø—Ç–æ–≤ (3-4 —á–∞—Å–∞)
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª "–ü—Ä–æ–º–ø—Ç—ã" –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ê–≥–µ–Ω—Ç–æ–≤
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä –ø—Ä–æ–º–ø—Ç–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å preview –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤

### Phase 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (2 —á–∞—Å–∞)
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å E2E —Ç–µ—Å—Ç –ª–æ–∫–∞–ª—å–Ω–æ
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≥—Ä–∞–Ω—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –û—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ —á–µ—Ä–µ–∑ UI
- [ ] –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –≥—Ä–∞–Ω—Ç–æ–≤

---

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å E2E —Ç–µ—Å—Ç–∞

### GigaChat:
- Auditor: ~500 tokens = $0.01
- Planner: ~800 tokens = $0.02
- Writer: ~8000 tokens = $0.20
- **Total: ~$0.23 –∑–∞ —Ç–µ—Å—Ç**

### Claude Code (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º):
- Auditor: ~600 tokens = $0.03
- Planner: ~1000 tokens = $0.05
- Writer: ~10000 tokens = $0.50
- **Total: ~$0.58 –∑–∞ —Ç–µ—Å—Ç**

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:
–ó–∞–ø—É—Å–∫–∞—Ç—å E2E —Ç–µ—Å—Ç—ã **–≤—Ä—É—á–Ω—É—é** –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º, –Ω–µ –≤ CI/CD.

---

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—É—á–∏–º:
1. ‚úÖ **–ù–∞—Å—Ç–æ—è—â–∏–π E2E —Ç–µ—Å—Ç** - —Ä–µ–∞–ª—å–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã, —Ä–µ–∞–ª—å–Ω—ã–µ LLM
2. ‚úÖ **–†–µ–∞–ª—å–Ω—ã–µ –≥—Ä–∞–Ω—Ç—ã** - –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è —Ñ–æ–Ω–¥–∞ –ø—Ä–µ–∑–∏–¥–µ–Ω—Ç—Å–∫–∏—Ö –≥—Ä–∞–Ω—Ç–æ–≤
3. ‚úÖ **UI –¥–ª—è –ø—Ä–æ–º–ø—Ç–æ–≤** - —É–¥–æ–±–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ –∫–æ–¥–∞
4. ‚úÖ **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - –º–æ–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
5. ‚úÖ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤ –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –°–æ–∑–¥–∞—Ç—å PR —Å —ç—Ç–∏–º –ø–ª–∞–Ω–æ–º –∏ –Ω–∞—á–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é Phase 1.
